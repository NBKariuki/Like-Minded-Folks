<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#090912">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Like-Minded Folks - MMF Tracker</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 rx=%2220%22 fill=%22%230d0d14%22/><text x=%2250%22 y=%2268%22 font-family=%22Arial,sans-serif%22 font-size=%2248%22 font-weight=%22700%22 fill=%22%2300e5a0%22 text-anchor=%22middle%22>L</text></svg>">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Sora:wght@400;600;700;800&family=JetBrains+Mono:wght@500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg:       #090912;
            --surface:  #0f0f1c;
            --card:     #131320;
            --elevated: #1a1a2e;
            --border:   rgba(255,255,255,0.08);
            --border-g: rgba(0,229,160,0.28);
            --accent:   #00e5a0;
            --accent-d: rgba(0,229,160,0.14);
            --blue:     #60a5fa;
            --blue-d:   rgba(96,165,250,0.14);
            --gold:     #f59e0b;
            --gold-d:   rgba(245,158,11,0.15);
            --red:      #f87171;
            --red-d:    rgba(248,113,113,0.12);
            --green:    #34d399;
            --t1:       #f0f0f8;
            --t2:       rgba(240,240,248,0.60);
            --t3:       rgba(240,240,248,0.35);
            --r-sm: 8px; --r-md: 12px; --r-lg: 18px; --r-xl: 24px;
        }

        * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Space Grotesk', -apple-system, sans-serif;
            background: var(--bg);
            min-height: 100vh;
            color: var(--t1);
            background-image:
                radial-gradient(ellipse 80% 40% at 20% 0%, rgba(0,229,160,0.05) 0%, transparent 60%),
                radial-gradient(ellipse 60% 30% at 80% 100%, rgba(96,165,250,0.04) 0%, transparent 60%);
            /* prevent overscroll bounce on iOS */
            overscroll-behavior: none;
        }

        /* Ensure buttons and selects are finger-friendly */
        button, select, input { touch-action: manipulation; }

        /* â”€â”€ LAYOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .app-layout {
            display: flex;
            max-width: 1360px;
            margin: 0 auto;
            min-height: 100vh;
        }

        /* â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .sidebar {
            width: 256px;
            flex-shrink: 0;
            background: var(--surface);
            border-right: 1px solid var(--border);
            padding: 16px 14px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 14px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 4px;
        }
        .sidebar-logo-icon {
            width: 36px; height: 36px;
            background: linear-gradient(135deg, var(--accent), var(--blue));
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.1rem; flex-shrink: 0;
        }
        .sidebar-logo-text { font-family: 'Sora', sans-serif; font-size: 0.9rem; font-weight: 700; line-height: 1.2; }
        .sidebar-logo-sub  { font-size: 0.68rem; color: var(--t3); font-weight: 400; }

        .sidebar-section {
            border: 1px solid var(--border);
            border-radius: var(--r-md);
            padding: 10px 12px;
            margin-bottom: 0;
            flex-shrink: 0;
        }
        .sidebar-section h3 {
            color: var(--t1);
            font-size: 0.62rem;
            font-weight: 700;
            letter-spacing: 0.09em;
            text-transform: uppercase;
            margin-bottom: 8px;
            display: flex; align-items: center; gap: 6px;
        }
        .sidebar-link {
            display: flex; align-items: center; justify-content: center; gap: 8px;
            padding: 10px 14px;
            background: var(--accent-d);
            border: 1px solid var(--border-g);
            border-radius: var(--r-sm);
            color: var(--accent);
            text-decoration: none;
            font-weight: 600; font-size: 0.85rem;
            transition: all 0.2s;
        }
        .sidebar-link:hover { background: rgba(0,229,160,0.22); transform: translateY(-1px); }

        .deposit-method {
            background: rgba(255,255,255,0.02);
            border: 1px solid var(--border);
            border-radius: var(--r-sm);
            padding: 8px; margin-bottom: 6px;
        }
        .deposit-method:last-child { margin-bottom: 0; }
        .deposit-title { color: var(--blue); font-weight: 700; font-size: 0.75rem; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em; }
        .deposit-info  { color: var(--t2); font-size: 0.78rem; line-height: 1.65; }
        .deposit-info strong { color: var(--t1); font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; }
        .deposit-warn  { margin-top: 7px; padding: 6px 8px; background: var(--gold-d); border: 1px solid rgba(245,158,11,0.2); border-radius: 6px; font-size: 0.72rem; color: var(--gold); line-height: 1.4; }

        .rules-list { list-style: none; color: var(--t2); font-size: 0.78rem; line-height: 1.7; }
        .rules-list li { display: flex; align-items: flex-start; gap: 6px; padding: 2px 0; }
        .rules-list li::before { content: 'â€“'; color: var(--accent); font-weight: 700; flex-shrink: 0; }
        .rules-list strong { color: var(--t1); }

        .pdf-password { font-size: 0.68rem; font-style: italic; color: var(--gold); text-align: right; margin-bottom: 7px; opacity: 0.85; }
        .statements-dropdown {
            width: 100%; padding: 9px 11px;
            font-size: 0.82rem; font-weight: 600;
            background: var(--accent-d); color: var(--accent);
            border: 1px solid var(--border-g); border-radius: var(--r-sm);
            font-family: 'Space Grotesk', sans-serif; cursor: pointer;
            transition: all 0.2s;
        }
        .statements-dropdown:hover { background: rgba(0,229,160,0.22); }

        .sidebar-close { display: none; text-align: right; margin-bottom: 14px; }
        .sidebar-close button {
            background: var(--red-d); border: 1px solid rgba(248,113,113,0.2);
            color: var(--red); padding: 7px 14px; border-radius: var(--r-sm);
            cursor: pointer; font-weight: 600; font-size: 0.85rem;
            font-family: 'Space Grotesk', sans-serif;
        }

        /* â”€â”€ MAIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .main-content { flex: 1; min-width: 0; padding: 24px 20px 72px; }

        /* â”€â”€ HEADER â€” centred â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .header { margin-bottom: 19px; text-align: center; }        .header-eyebrow {
            font-size: 0.72rem; font-weight: 700; letter-spacing: 0.12em;
            text-transform: uppercase; color: var(--accent); margin-bottom: 4px;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .header-eyebrow::before { content:''; display:inline-block; width:18px; height:2px; background:var(--accent); border-radius:2px; }
        .header h1 {
            font-family: 'Sora', sans-serif;
            font-size: clamp(1.6rem, 4vw, 2.3rem);
            font-weight: 800; letter-spacing: -0.02em; line-height: 1.1; margin-bottom: 3px;
        }
        .header-sub { color: var(--t2); font-size: 0.88rem; font-weight: 500; }

        /* â”€â”€ SECTION LABELS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .section-label {
            font-size: 0.65rem; font-weight: 700; color: var(--t1);
            text-transform: uppercase; letter-spacing: 0.1em;
            margin-bottom: 8px;
        }

        /* â”€â”€ MONTH SELECTOR â€” 5mm above label, 10mm below grid â”€â”€â”€ */
        .month-selector {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 6px;
            margin-bottom: 38px;
            width: 100%;
        }
        .month-btn {
            padding: 10px 4px;
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--t2);
            border-radius: var(--r-md);
            cursor: pointer;
            transition: all 0.18s;
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600; font-size: 0.82rem;
            text-align: center; min-height: 42px;
        }
        .month-btn:hover { color: var(--t1); background: var(--elevated); border-color: rgba(255,255,255,0.13); }
        .month-btn.active {
            background: var(--accent); border-color: var(--accent);
            color: #090912; font-weight: 700;
            box-shadow: 0 2px 14px rgba(0,229,160,0.32);
        }

        /* â”€â”€ VIEW TOGGLE â€” 10mm below view section â”€ */
        .view-toggle { display: flex; gap: 8px; margin-bottom: 38px; }
        .toggle-btn {
            padding: 10px 20px;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--t2); font-weight: 600; font-size: 0.88rem;
            cursor: pointer; border-radius: 30px;
            transition: all 0.2s; font-family: 'Space Grotesk', sans-serif;
        }
        .toggle-btn:hover { border-color: rgba(255,255,255,0.15); color: var(--t1); }
        .toggle-btn.active { background: var(--elevated); border-color: var(--border-g); color: var(--accent); }

        /* â”€â”€ MEMBER VIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .member-view { max-width: 580px; margin: 0 auto; }

        /* 10mm below alias selector before rest */
        .alias-selector { margin-bottom: 38px; }
        .alias-selector select {
            width: 100%; padding: 14px 16px; font-size: 1rem; font-weight: 600;
            background: var(--surface); color: var(--t1);
            border: 1px solid var(--border-g); border-radius: var(--r-md);
            font-family: 'Space Grotesk', sans-serif; cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2300e5a0' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: right 16px center;
            padding-right: 42px; transition: all 0.2s;
            animation: selectPulse 2.4s ease-in-out infinite;
        }
        @keyframes selectPulse {
            0%,100% { box-shadow: 0 0 0 0 rgba(0,229,160,0); border-color: rgba(0,229,160,0.28); }
            50%      { box-shadow: 0 0 0 6px rgba(0,229,160,0.12), 0 0 18px rgba(0,229,160,0.18); border-color: rgba(0,229,160,0.7); }
        }
        .alias-selector select:focus {
            outline: none; border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(0,229,160,0.15);
            animation: none;
        }
        .alias-selector select option { background: var(--elevated); color: var(--t1); }

        /* â”€â”€ STATEMENT CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .member-statement {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--r-xl);
            padding: 26px;
            margin-bottom: 18px;
            position: relative; overflow: hidden;
        }
        .member-statement::before {
            content:''; position:absolute; top:0; left:0; right:0; height:3px;
            background: linear-gradient(90deg, var(--accent), var(--blue));
        }
        .statement-alias {
            font-family: 'Sora', sans-serif; font-size: 1.7rem; font-weight: 800;
            letter-spacing: -0.02em; margin-bottom: 3px;
            background: linear-gradient(120deg, var(--accent), var(--blue));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .statement-month { color: var(--t3); font-size: 0.82rem; font-weight: 500; margin-bottom: 20px; }
        .statement-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 11px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .statement-row:last-child {
            border-bottom: none; border-top: 1px solid var(--border-g);
            padding-top: 16px; margin-top: 8px;
        }
        .statement-label { font-weight: 500; color: var(--t2); font-size: 0.9rem; }
        .statement-value { font-weight: 700; font-size: 1rem; color: var(--t1); font-family: 'JetBrains Mono', monospace; text-align: right; }
        .statement-value.closing { color: var(--accent); font-size: 1.5rem; }
        .statement-value.blue    { color: var(--blue); }
        .statement-value.green   { color: var(--green); }
        .early-hint { font-size: 0.65rem; font-style: italic; color: var(--gold); margin-top: 2px; opacity: 0.85; }
        .data-timestamp { color: var(--t3); font-size: 0.72rem; margin-top: 14px; text-align: center; }

        /* â”€â”€ PRIVACY NOTICE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .privacy-notice {
            margin-top: 19px;
            margin-bottom: 0;
            padding: 11px 14px;
            background: rgba(248,113,113,0.07);
            border: 1px solid rgba(248,113,113,0.3);
            border-left: 4px solid #f87171;
            border-radius: var(--r-md);
            display: flex;
            align-items: center;
            gap: 10px;
            animation: privacyPulse 3s ease-in-out infinite;
        }
        @keyframes privacyPulse {
            0%,100% { border-left-color: #f87171; box-shadow: 0 0 0 0 rgba(248,113,113,0); }
            50%      { border-left-color: #fca5a5; box-shadow: 0 0 10px rgba(248,113,113,0.15); }
        }
        .privacy-lock {
            font-size: 1.1rem;
            flex-shrink: 0;
        }
        .privacy-title {
            font-size: 0.72rem;
            font-weight: 700;
            color: #fca5a5;
            letter-spacing: 0.03em;
            margin-bottom: 2px;
            text-transform: uppercase;
        }
        .privacy-body {
            font-size: 0.7rem;
            color: var(--t2);
            line-height: 1.4;
        }

        /* â”€â”€ WARNING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .warning-message {
            background: var(--gold-d); border: 1px solid rgba(245,158,11,0.25);
            border-radius: var(--r-md); padding: 13px 15px; margin-bottom: 18px;
            display: flex; align-items: flex-start; gap: 11px;
        }
        .warning-icon { font-size: 1.2rem; flex-shrink: 0; }
        .warning-title { color: var(--gold); font-weight: 700; font-size: 0.78rem; margin-bottom: 3px; text-transform: uppercase; letter-spacing: 0.05em; }
        .warning-content { color: rgba(240,240,248,0.85); font-size: 0.82rem; line-height: 1.5; }

        /* â”€â”€ GROUP SUMMARY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .group-summary {
            background: var(--card); border: 1px solid var(--border-g);
            border-radius: var(--r-xl); padding: 18px 20px;
            margin: 19px auto 0; max-width: 600px;
        }
        .group-summary-title {
            font-size: 0.65rem; font-weight: 700; color: var(--t3);
            letter-spacing: 0.1em; text-transform: uppercase;
            margin-bottom: 14px; text-align: center;
        }
        .group-summary-grid {
            display: flex; flex-direction: column; gap: 0;
        }
        .summary-item {
            display: flex; align-items: center; justify-content: space-between;
            padding: 11px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .summary-item:last-child { border-bottom: none; padding-bottom: 0; }
        .summary-item:first-child { padding-top: 0; }
        .summary-label {
            font-size: 0.82rem; color: var(--t2);
            font-weight: 500;
        }
        .summary-value {
            font-size: 1rem; font-weight: 700;
            color: var(--blue); font-family: 'JetBrains Mono', monospace;
            white-space: nowrap;
        }

        /* â”€â”€ CHART CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .chart-card {
            background: var(--card); border: 1px solid var(--border);
            border-radius: var(--r-xl); padding: 20px; margin-bottom: 16px;
        }
        .chart-card-label {
            font-size: 0.68rem; font-weight: 700; color: var(--t3);
            letter-spacing: 0.09em; text-transform: uppercase; margin-bottom: 3px;
        }
        .chart-card-sub { font-size: 0.78rem; color: var(--t2); margin-bottom: 14px; }

        /* â”€â”€ MOTIVATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .motivation-card {
            background: var(--card); border: 1px solid var(--border-g);
            border-radius: var(--r-lg); padding: 16px;
            margin-bottom: 60px;
            display: flex; align-items: flex-start; gap: 13px;
        }
        .motivation-icon { font-size: 1.5rem; line-height: 1; flex-shrink: 0; }
        .motivation-text { font-size: 0.84rem; line-height: 1.6; color: var(--t2); }

        /* â”€â”€ ALL MEMBERS TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .all-members-header {
            display: flex; align-items: center; justify-content: space-between;
            flex-wrap: wrap; gap: 10px; margin-bottom: 16px;
        }
        .all-members-title { font-family: 'Sora', sans-serif; font-size: 1.2rem; font-weight: 700; }

        .search-wrapper { display: flex; align-items: center; gap: 8px; }
        .search-input-wrap { position: relative; }
        .search-input {
            padding: 8px 30px 8px 12px; font-size: 0.82rem;
            border: 1px solid var(--border); border-radius: var(--r-md);
            background: var(--surface); color: var(--t1);
            font-family: 'Space Grotesk', sans-serif; outline: none; width: 180px;
            transition: all 0.2s;
        }
        .search-input:focus { border-color: var(--border-g); width: 220px; }
        .search-input::placeholder { color: var(--t3); }
        .search-clear {
            position: absolute; right: 7px; top: 50%; transform: translateY(-50%);
            background: transparent; border: none; color: var(--t3); cursor: pointer; font-size: 1rem;
        }
        .search-count { font-size: 0.75rem; color: var(--t3); white-space: nowrap; }

        /* TABLE â€” no horizontal scroll, compact columns */
        .members-table-container {
            margin-bottom: 60px;
            border: 1px solid var(--border);
            border-radius: var(--r-lg);
            overflow: hidden;    /* no x-scroll wrapper */
            width: 100%;
        }
        .members-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;  /* fixed layout = no overflow */
        }
        .members-table thead { background: var(--surface); }
        .members-table th {
            padding: 10px 6px;
            font-size: 0.62rem; font-weight: 700; color: var(--t3);
            letter-spacing: 0.07em; text-transform: uppercase;
            border-bottom: 1px solid var(--border);
            white-space: nowrap; overflow: hidden;
        }
        .members-table th:first-child { width: 30px; text-align: center; }
        .members-table th:nth-child(2) { width: 22%; text-align: left; }
        .members-table th:nth-child(3),
        .members-table th:nth-child(4),
        .members-table th:nth-child(5),
        .members-table th:nth-child(6) { text-align: right; }

        .members-table td {
            padding: 10px 6px; font-size: 0.78rem;
            border-bottom: 1px solid rgba(255,255,255,0.04);
            background: var(--card); vertical-align: middle;
            overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
        }
        .members-table tbody tr:hover td { background: rgba(255,255,255,0.03); }
        .members-table tbody tr:last-child td { border-bottom: none; }

        .members-table .rank-col { text-align: center; color: var(--t3); font-size: 0.78rem; }
        .members-table .alias-col { font-weight: 700; color: var(--t1); text-align: left; }
        .members-table .num-col {
            text-align: right;
            font-family: 'JetBrains Mono', monospace; color: var(--t2);
            font-size: 0.75rem;
        }
        .members-table .num-col.closing { color: var(--blue); font-weight: 700; }
        .members-table .total-row td {
            background: rgba(0,229,160,0.05);
            border-top: 1px solid var(--border-g);
            font-weight: 700; color: var(--accent); padding: 12px 6px;
        }

        .topup-cell {
            display: flex; align-items: center;
            justify-content: flex-end; gap: 5px;
        }
        .status-dot {
            display: inline-block; width: 7px; height: 7px;
            border-radius: 50%; flex-shrink: 0; cursor: help;
        }

        /* â”€â”€ LOADING / ERROR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .loading { text-align: center; padding: 80px 20px; }
        .loading-spinner {
            width: 34px; height: 34px;
            border: 3px solid var(--border); border-top-color: var(--accent);
            border-radius: 50%; animation: spin 0.8s linear infinite;
            margin: 0 auto 14px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-text { color: var(--t2); font-size: 0.9rem; }

        .error {
            background: var(--red-d); border: 1px solid rgba(248,113,113,0.2);
            border-radius: var(--r-lg); padding: 24px; margin: 20px;
            text-align: center; color: var(--red);
        }
        .btn-secondary {
            background: var(--elevated); color: var(--t1);
            border: 1px solid var(--border); padding: 9px 20px;
            font-weight: 600; font-size: 0.85rem; border-radius: var(--r-md);
            cursor: pointer; font-family: 'Space Grotesk', sans-serif;
            margin: 10px 5px 0; transition: all 0.2s;
        }
        .btn-secondary:hover { border-color: var(--border-g); color: var(--accent); }

        /* â”€â”€ MOBILE TOGGLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .mobile-menu-toggle {
            display: none; position: fixed; bottom: 22px; right: 22px;
            background: var(--accent); color: #090912;
            border: none; border-radius: 50%; width: 54px; height: 54px;
            font-size: 1.3rem; cursor: pointer;
            box-shadow: 0 4px 24px rgba(0,229,160,0.35); z-index: 1000;
            align-items: center; justify-content: center;
        }

        /* â”€â”€ TOUR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .tour-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.65); z-index: 9998; }
        .tour-highlight {
            position: absolute; border-radius: var(--r-md);
            box-shadow: 0 0 0 3px var(--accent), 0 0 0 9999px rgba(0,0,0,0.6);
            z-index: 9999; pointer-events: none; transition: all 0.35s;
        }
        .tour-tooltip {
            position: absolute; z-index: 10000;
            background: var(--elevated); border: 1px solid var(--border-g);
            border-radius: var(--r-lg); padding: 20px 20px 15px;
            max-width: 280px; width: 90vw; box-shadow: 0 8px 32px rgba(0,0,0,0.5);
        }
        .tour-tooltip-arrow { position: absolute; width: 11px; height: 11px; background: var(--elevated); border-left: 1px solid var(--border-g); border-bottom: 1px solid var(--border-g); }
        .tour-tooltip-arrow.arrow-top    { top: -6px;    left: 28px; transform: rotate(-135deg); }
        .tour-tooltip-arrow.arrow-bottom { bottom: -6px; left: 28px; transform: rotate(45deg);   }
        .tour-step-badge { display: inline-block; background: var(--accent-d); color: var(--accent); border: 1px solid var(--border-g); font-size: 0.62rem; font-weight: 700; padding: 3px 10px; border-radius: 20px; margin-bottom: 9px; letter-spacing: 0.06em; }
        .tour-tooltip h4 { color: var(--t1); font-size: 0.92rem; margin-bottom: 7px; font-weight: 700; }
        .tour-tooltip p  { color: var(--t2); font-size: 0.8rem; line-height: 1.5; }
        .tour-controls   { display: flex; justify-content: space-between; align-items: center; margin-top: 14px; }
        .tour-btn-next   { background: var(--accent); color: #090912; border: none; padding: 7px 17px; border-radius: 20px; font-weight: 700; font-size: 0.8rem; cursor: pointer; font-family: 'Space Grotesk', sans-serif; }
        .tour-btn-skip   { background: none; border: none; color: var(--t3); font-size: 0.75rem; cursor: pointer; font-family: 'Space Grotesk', sans-serif; }
        .tour-btn-skip:hover { color: var(--t2); }
        .tour-dots  { display: flex; gap: 5px; align-items: center; }
        .tour-dot   { width: 6px; height: 6px; border-radius: 50%; background: var(--border); }
        .tour-dot.active { background: var(--accent); }

        /* â”€â”€ PASSWORD SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .password-screen {
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; padding: 20px; background: var(--bg);
            background-image: radial-gradient(ellipse 70% 50% at 50% 0%, rgba(0,229,160,0.07) 0%, transparent 70%);
        }
        .password-card {
            background: var(--card); border: 1px solid var(--border);
            border-radius: var(--r-xl); padding: 44px;
            max-width: 400px; width: 100%; text-align: center;
            position: relative; overflow: hidden;
        }
        .password-card::before { content:''; position:absolute; top:0; left:0; right:0; height:3px; background: linear-gradient(90deg, var(--accent), var(--blue)); }
        .password-title { font-family: 'Sora', sans-serif; font-size: 1.6rem; font-weight: 800; letter-spacing: -0.02em; margin-bottom: 4px; }
        .password-subtitle { color: var(--t3); font-size: 0.82rem; margin-bottom: 30px; }
        .password-lock { font-size: 2.4rem; margin-bottom: 18px; display: block; }
        .password-input {
            width: 100%; padding: 13px 16px; font-size: 0.95rem; font-weight: 600;
            background: var(--surface); color: var(--t1); border: 1px solid var(--border);
            border-radius: var(--r-md); font-family: 'Space Grotesk', sans-serif;
            margin-bottom: 11px; outline: none; transition: all 0.2s;
            text-align: center; letter-spacing: 0.08em;
        }
        .password-input:focus { border-color: var(--border-g); box-shadow: 0 0 0 3px rgba(0,229,160,0.1); }
        .password-input.err { border-color: rgba(248,113,113,0.4); }
        .password-error { background: var(--red-d); border: 1px solid rgba(248,113,113,0.2); border-radius: 7px; padding: 9px; margin-bottom: 11px; color: var(--red); font-size: 0.8rem; }
        .password-btn {
            width: 100%; padding: 13px; font-size: 0.9rem; font-weight: 700;
            background: var(--accent); color: #090912; border: none; border-radius: var(--r-md);
            cursor: pointer; font-family: 'Space Grotesk', sans-serif; transition: all 0.2s; letter-spacing: 0.02em;
        }
        .password-btn:hover { background: #00ffb2; transform: translateY(-1px); box-shadow: 0 4px 20px rgba(0,229,160,0.3); }
        .password-help { margin-top: 18px; color: var(--t3); font-size: 0.73rem; line-height: 1.6; }

        /* â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        @media (max-width: 968px) {
            .app-layout { flex-direction: column; }
            .sidebar {
                width: 100%; display: none;
                position: fixed; top: 0; left: 0; right: 0; bottom: 0;
                height: 100vh; z-index: 999; overflow-y: scroll;
                -webkit-overflow-scrolling: touch;
                padding: 20px 20px 40px; border-right: none;
            }
            .sidebar.mobile-open { display: flex; }
            .sidebar-close { display: block; }
            .mobile-menu-toggle { display: flex; }
            .main-content { padding: 16px 14px; }
            .group-summary { margin-top: 19px; }
        }

        @media (max-width: 480px) {
            .main-content { padding: 14px 12px; }

            /* Header â€” stays centred, readable */
            .header { margin-bottom: 19px; }
            .header h1 { font-size: 1.5rem; }
            .header-sub { font-size: 0.84rem; }

            /* Month buttons */
            .month-selector { gap: 5px; margin-bottom: 38px; }
            .month-btn { font-size: 0.76rem; padding: 9px 3px; min-height: 40px; }

            /* View toggle */
            .view-toggle { gap: 6px; margin-bottom: 38px; }
            .toggle-btn { flex: 1; text-align: center; font-size: 0.84rem; }

            /* Alias â€” 10mm gap below */
            .alias-selector { margin-bottom: 38px; }
            .alias-selector select { padding: 13px 38px 13px 13px; font-size: 0.95rem; }

            /* Statement card */
            .member-statement { padding: 18px 16px; margin-bottom: 16px; }
            .statement-alias { font-size: 1.4rem; }
            .statement-label { font-size: 0.88rem; }
            .statement-value { font-size: 0.95rem; }
            .statement-value.closing { font-size: 1.25rem; }

            /* Group summary */
            .group-summary { margin-top: 19px; padding: 16px 18px; }

            /* Privacy notice */
            .privacy-notice { margin-top: 19px; }

            /* Members table */
            .members-table th { font-size: 0.6rem; }
            .members-table td { font-size: 0.78rem; }
            .mobile-menu-toggle { bottom: 18px; right: 16px; }
        }

        @media (max-width: 360px) {
            .month-btn { font-size: 0.68rem; min-height: 36px; }
            .header h1 { font-size: 1.3rem; }
            .summary-value { font-size: 0.88rem; }
        }

        @keyframes shake {
            0%,100% { transform: translateX(0); }
            25%      { transform: translateX(-8px); }
            75%      { transform: translateX(8px); }
        }
        @keyframes fadeIn {
            from { opacity:0; transform: translateY(5px); }
            to   { opacity:1; transform: translateY(0); }
        }
        .fade-in { animation: fadeIn 0.22s ease both; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const MEMBERS = ['Tokyo', 'Berlin', 'Gandia', 'Denver', 'Helsinki', 'Oslo', 
                        'Moscow', 'California', 'Lisbon', 'Stockholm', 'Paris', 'Marseille', 
                        'Rio', 'Nairobi', 'Tel Aviv', 'Valencia', 'Havana', 'Manilla', 'Scofield', 
                        'Bogota', 'Emirates', 'Dublin', 'Doha', 'Bern'];
        const MONTHS = ['January', 'February', 'March', 'April', 'May', 'June', 
                       'July', 'August', 'September', 'October', 'November', 'December'];
        
        const ENCODED_CSV_URLS = [
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTE4ODE3NjExNTQmc2luZ2xlPXRydWUmb3V0cHV0PWNzdg==",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTExODIwNzc2Mjcmc2luZ2xlPXRydWUmb3V0cHV0PWNzdg==",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTExNDkyMjYwMjQmc2luZ2xlPXRydWUmb3V0cHV0PWNzdg==",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTk2MjExMTcwNCZzaW5nbGU9dHJ1ZSZvdXRwdXQ9Y3N2",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTUxNDQ5Mjc4MiZzaW5nbGU9dHJ1ZSZvdXRwdXQ9Y3N2",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTU5OTQ2MTg1NyZzaW5nbGU9dHJ1ZSZvdXRwdXQ9Y3N2",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTcwMzc5MjUzMCZzaW5nbGU9dHJ1ZSZvdXRwdXQ9Y3N2",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTIwOTM3MDg5Nzkmc2luZ2xlPXRydWUmb3V0cHV0PWNzdg==",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTEwNzkyMzcwNDMmc2luZ2xlPXRydWUmb3V0cHV0PWNzdg==",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTM2MjM4OTY0MCZzaW5nbGU9dHJ1ZSZvdXRwdXQ9Y3N2",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTM1MDMxNTkyMiZzaW5nbGU9dHJ1ZSZvdXRwdXQ9Y3N2",
            "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlN2RXUzZVhzd0FRSXZ6Y2dZVE5ZSkFNTEhad0F6Z0REOExxVWl1MHRtQzhTalRXVWlfWjFZQkowWlJoeW93ZkpBNUJJT1VQVkp5N3R2ai9wdWI/Z2lkPTEwMTY1NjE3OTgmc2luZ2xlPXRydWUmb3V0cHV0PWNzdg=="
        ];
        
        const decodeURL = (encoded) => atob(encoded);
        const calculateMovingAverage = (data, windowSize = 2) => {
            if (data.length < windowSize) return data;
            const result = [];
            for (let i = 0; i < data.length; i++) {
                if (data[i] === null) { result.push(null); }
                else if (i < windowSize - 1) { result.push(data[i]); }
                else {
                    const window = data.slice(i - windowSize + 1, i + 1).filter(v => v !== null);
                    result.push(window.reduce((s,v) => s+v, 0) / window.length);
                }
            }
            return result;
        };
        
        const MONTH_CSV_URLS = {};
        MONTHS.forEach((month, index) => { MONTH_CSV_URLS[month] = decodeURL(ENCODED_CSV_URLS[index]); });
        
        const MINIMUM_CONTRIBUTION = 4000;
        const ETICA_ANNUAL_YIELD   = 0.12;
        const ETICA_MONTHLY_YIELD  = ETICA_ANNUAL_YIELD / 12;
        const WARNING_START_DAY    = 10;
        
        const MEMBER_PAIRS = {
            'California': 'Lisbon', 'Lisbon': 'California',
            'Paris': 'Marseille',   'Marseille': 'Paris'
        };

        const PARTIAL_CONTRIBUTION_MESSAGES = [
            (a,r) => `Hey there! ðŸ‘‹ You've put in KES ${a.toLocaleString()} this month. Just KES ${r.toLocaleString()} more and you're all set for interest. You've got this! ðŸ’ª`,
            (a,r) => `Nice start! ðŸŒŸ You're at KES ${a.toLocaleString()} so far. Top up KES ${r.toLocaleString()} more to unlock this month's interest. Almost there!`,
            (a,r) => `Good progress! ðŸŽ¯ Your KES ${a.toLocaleString()} is working. Add KES ${r.toLocaleString()} more to hit the minimum and earn interest. Keep going!`,
            (a,r) => `You're on the right track! ðŸš€ KES ${a.toLocaleString()} down, KES ${r.toLocaleString()} to go. Top up soon!`,
            (a,r) => `Almost there! ðŸ˜Š You've contributed KES ${a.toLocaleString()}. Just KES ${r.toLocaleString()} more to qualify for interest this month!`
        ];
        
        const CURRENT_YEAR = new Date().getFullYear();
        function getCurrentMonth() { return MONTHS[new Date().getMonth()]; }

        const CORRECT_PASSWORD  = 'LikeMinded2026';
        const AUTH_EXPIRY_DAYS  = 30;

        const ARCHETYPE_MESSAGES = {
            OVERACHIEVER: [
                { icon: 'ðŸ†', text: "You're in the top 3! At this pace, you're on track for **{projected}** by December. Your early deposits are earning you way more interest than late contributors." },
                { icon: 'ðŸ’Ž', text: "Star performer! You've earned **{interest}** in interest so far. Keep this up!" },
                { icon: 'ðŸš€', text: "Your balance is growing faster than **{percentBeaten}%** of the group. December projection: **{projected}**." },
                { icon: 'ðŸ”¥', text: "On fire! You're projected to hit **{projected}** by December. **{stretchGoal}** is totally within reach." },
                { icon: 'ðŸ‘‘', text: "Top tier! You've contributed **{totalTopups}** so far. December you will have **{projected}**. That's a serious emergency fund." },
            ],
            STEADY_CLIMBER: [
                { icon: 'ðŸŒ±', text: "Solid progress! Projected **{projected}** by December. Just **KES 1,000 more/month** pushes that to **{stretchGoal}**." },
                { icon: 'ðŸ’ª', text: "Consistent wins! If you deposited **3 days earlier** each month, you'd earn **KES 200+ more interest** by December." },
                { icon: 'ðŸ“ˆ', text: "Steady climb! Your average deposit is **{avgDeposit}**/month. December: **{projected}** with **{projectedInterest}** in interest." },
                { icon: 'ðŸš¶', text: "One step at a time! On track for **{projected}** by December. **{monthsLeft}** months of steady contributions away." },
                { icon: 'ðŸŽŠ', text: "You're doing great! **{percentBeaten}%** of members are behind you. Keep going and you'll crack **{projected}** by December." }
            ],
            LATE_BLOOMER: [
                { icon: 'ðŸ”¥', text: "Look at you go! From **{previousMonthTopup}** last month to **{currentMonthTopup}** this month. Keep this momentum and you'll hit **{projected}** by December." },
                { icon: 'ðŸŒ…', text: "Late bloomer alert! You're gaining speed. **{avgDeposit}**/month â†’ **{projected}** by year-end." },
                { icon: 'ðŸ“ˆ', text: "Upward trajectory! Last: **{previousMonthTopup}**. Now: **{currentMonthTopup}**. Next month? Hit **{suggestedNextDeposit}** and you're on a roll." },
                { icon: 'ðŸŽ¯', text: "You're catching up fast! **{totalTopups}** total â†’ **{projected}** by December. That's real money!" },
                { icon: 'ðŸŽ‰', text: "Progress party! You've more than doubled your deposit this month. December: **{projected}**." }
            ],
            PARTIAL_CONTRIBUTOR: [
                { icon: 'ðŸŽ¯', text: "You've put in {currentMonthTopup} this month. Just {gapToMinimum} away from qualifying for interest. Doable!" },
                { icon: 'ðŸ’š', text: "Good news: {similarMembers} members started at your level and hit the minimum by month-end. Just {gapToMinimum} more!" },
                { icon: 'â°', text: "You still have time left in the month. {gapToMinimum} is all you need to qualify for interest." },
                { icon: 'ðŸŒ±', text: "Every shilling counts! Add {gapToMinimum} more and you'll earn interest this month." },
                { icon: 'ðŸ’ª', text: "You're {gapToMinimum} away from interest. Hit it and you'll start earning on {currentBalance}." }
            ],
            GHOST: [
                { icon: 'ðŸ‘‹', text: "It's not too late! Start with just {minimum} this month. By December, that becomes real money plus interest." },
                { icon: 'â°', text: "Every month you wait costs you growth. Deposit {minimum} now and December you will thank today you." },
                { icon: 'ðŸ’ª', text: "No judgment, just math: {minimum}/month for {monthsLeft} months = {lateStartProjection} by December. Still worth it!" },
                { icon: 'ðŸŽ¯', text: "Your seat is still warm! Deposit {minimum} this month. Even starting late, you'll have {lateStartProjection} by year-end." },
                { icon: 'âœ¨', text: "The best time to start was January. The second best time is today. {minimum} gets you in the game." }
            ],
            EARLY_BIRD: [
                { icon: 'ðŸ¦', text: "Early bird gets the interest! Your deposit is earning more than late-month deposits. December: **{projected}**!" },
                { icon: 'â°', text: "Perfect timing! You're earning more interest than average just by depositing early. That's free money for good habits." },
                { icon: 'ðŸŽ¯', text: "Nailed it! Early deposits mean more earning days. On track for **{projected}** by December." },
                { icon: 'ðŸ’Ž', text: "Premium timing! You're maximizing interest by depositing early. December you: **{projected}**." },
            ],
            BIG_DEPOSITOR: [
                { icon: 'ðŸ‹', text: "Whale alert! Your {currentBalance} is the group's backbone. Projected {projected} by December." },
                { icon: 'ðŸ‘‘', text: "Your {avgDeposit}/month is above average. December you: {projected}. Respect!" },
                { icon: 'ðŸŒŸ', text: "Star power! Your {totalTopups} in contributions are setting the pace. Projected {projected} by December." },
            ],
            ACCELERATOR: [
                { icon: 'ðŸš€', text: "Momentum builder! From {previousMonthTopup} to {currentMonthTopup} this month. Keep this and you'll blow past {projected}!" },
                { icon: 'ðŸ“ˆ', text: "You're scaling up! Deposits growing {percentIncrease}% month-over-month. December could surprise with {stretchGoal}." },
                { icon: 'ðŸ”¥', text: "On fire! Contributions jumped from {previousMonthTopup} to {currentMonthTopup}. Hit {stretchGoal} by year-end." },
            ],
            STEADY_CONTRIBUTOR: [
                { icon: 'ðŸŽ¯', text: "Consistency wins! You've hit {avgDeposit} like clockwork. December: {projected}." },
                { icon: 'âš™ï¸', text: "Autopilot mode. Your steady {avgDeposit}/month is compounding nicely. By December: {projected}+." },
                { icon: 'ðŸ†', text: "Steady wins the race. {avgDeposit} deposits earning you {projected} by year-end." }
            ],
            DECELERATOR: [
                { icon: 'âš ï¸', text: "Heads up! You dropped from {previousMonthTopup} to {currentMonthTopup} this month. Try to get back on track." },
                { icon: 'ðŸ’¡', text: "Your balance is still growing, but slower. Bump back to {suggestedNextDeposit}/month to hit {projected}." },
                { icon: 'ðŸ›¤ï¸', text: "You're slipping a bit. Get back to {minimum}+ and December you hits {projected}." }
            ],
            VOLATILE: [
                { icon: 'ðŸŽ¢', text: "Rollercoaster rider! Try smoothing to {avgDeposit} consistently for better growth to {projected}." },
                { icon: 'ðŸŽ²', text: "Wildcard! Aim for {minimum}+ steadily to maximize compound interest." },
            ]
        };

        function getAuthToken() {
            try {
                const raw = localStorage.getItem('mmf_auth');
                if (!raw) return null;
                const token = JSON.parse(raw);
                if (new Date().getTime() > token.expiresAt) { localStorage.removeItem('mmf_auth'); return null; }
                return token;
            } catch(e) { localStorage.removeItem('mmf_auth'); return null; }
        }

        function setAuthToken() {
            localStorage.setItem('mmf_auth', JSON.stringify({
                authenticated: true,
                expiresAt: new Date().getTime() + (AUTH_EXPIRY_DAYS * 86400000)
            }));
        }

        function calculateMemberArchetype(memberData, allMembersData, currentMonth) {
            const { totalTopups, currentMonthTopup, closingBalance, daysActive, previousMonthTopup } = memberData;
            const monthIndex = MONTHS.indexOf(currentMonth);
            const monthsElapsed = monthIndex + 1;
            const sortedMembers = [...allMembersData].sort((a,b) => b.closingBalance - a.closingBalance);
            const rank = sortedMembers.findIndex(m => m.closingBalance === closingBalance) + 1;
            if (totalTopups === 0) return 'GHOST';
            if (currentMonthTopup > 0 && currentMonthTopup < MINIMUM_CONTRIBUTION) return 'PARTIAL_CONTRIBUTOR';
            if (monthIndex > 0 && previousMonthTopup !== undefined) {
                const trendChange  = currentMonthTopup - previousMonthTopup;
                const trendPercent = previousMonthTopup > 0 ? (trendChange / previousMonthTopup) * 100 : 0;
                if (Math.abs(trendPercent) > 50 && monthIndex > 1) return 'VOLATILE';
                if (trendChange > 0 && trendPercent > 20) return 'ACCELERATOR';
                if (trendChange < 0 && trendPercent < -20 && currentMonthTopup >= MINIMUM_CONTRIBUTION) return 'DECELERATOR';
            }
            const avgDeposit = monthsElapsed > 0 ? totalTopups / monthsElapsed : 0;
            if (rank <= 3 && closingBalance > 0) return 'OVERACHIEVER';
            if (daysActive <= 5 && currentMonthTopup >= MINIMUM_CONTRIBUTION) return 'EARLY_BIRD';
            if (avgDeposit > MINIMUM_CONTRIBUTION * 2) return 'BIG_DEPOSITOR';
            if (currentMonthTopup >= MINIMUM_CONTRIBUTION) {
                const variance = Math.abs(currentMonthTopup - avgDeposit) / (avgDeposit || 1);
                return variance < 0.15 ? 'STEADY_CONTRIBUTOR' : 'STEADY_CLIMBER';
            }
            return 'STEADY_CLIMBER';
        }

        function formatArchetypeMessage(archetype, memberData, allMembersData, currentMonth) {
            try {
                const messages = ARCHETYPE_MESSAGES[archetype] || ARCHETYPE_MESSAGES.STEADY_CLIMBER;
                let available = messages;
                const monthIndex = MONTHS.indexOf(currentMonth);
                if (monthIndex === 0) {
                    const trendTypes = ['LATE_BLOOMER','ACCELERATOR','DECELERATOR','VOLATILE'];
                    if (trendTypes.includes(archetype)) {
                        available = messages.filter(m => !m.text.includes('{previousMonthTopup}') && !m.text.includes('{previousInterest}'));
                        if (!available.length) available = ARCHETYPE_MESSAGES.STEADY_CLIMBER;
                    }
                }
                const msg = available[Math.floor(Math.random() * available.length)];
                const monthsElapsed   = monthIndex + 1;
                const monthsRemaining = 12 - monthsElapsed;
                const avgDeposit      = monthsElapsed > 0 ? (memberData.totalTopups || 0) / monthsElapsed : 0;
                const projected       = (memberData.closingBalance || 0) + (avgDeposit * monthsRemaining);
                const stretchGoal     = (memberData.closingBalance || 0) + ((avgDeposit * 1.5) * monthsRemaining);
                const suggestedNext   = Math.round((memberData.currentMonthTopup || 0) * 1.2);
                const prevTopup       = memberData.previousMonthTopup || 0;
                const balanceIncrease = prevTopup > 0 ? Math.round(((memberData.currentMonthTopup - prevTopup) / prevTopup) * 100) : 0;
                const estimatedInterest = ((memberData.closingBalance||0) + (avgDeposit*monthsRemaining)) * ETICA_MONTHLY_YIELD * monthsRemaining;
                const shareOfTotal    = allMembersData.length > 0 ? Math.round(((memberData.closingBalance||0) / allMembersData.reduce((s,m)=>s+(m.closingBalance||0),0))*100) : 0;
                const lateStart       = MINIMUM_CONTRIBUTION * monthsRemaining + (MINIMUM_CONTRIBUTION * monthsRemaining * ETICA_MONTHLY_YIELD * (monthsRemaining/2));
                let text = msg.text
                    .replace(/{projected}/g,           `KES ${Math.round(projected).toLocaleString()}`)
                    .replace(/{stretchGoal}/g,         `KES ${Math.round(stretchGoal).toLocaleString()}`)
                    .replace(/{totalTopups}/g,         `KES ${(memberData.totalTopups||0).toLocaleString()}`)
                    .replace(/{currentMonthTopup}/g,   `KES ${(memberData.currentMonthTopup||0).toLocaleString()}`)
                    .replace(/{previousMonthTopup}/g,  `KES ${prevTopup.toLocaleString()}`)
                    .replace(/{interest}/g,            `KES ${(memberData.totalInterest||0).toLocaleString()}`)
                    .replace(/{currentInterest}/g,     `KES ${(memberData.currentInterest||0).toLocaleString()}`)
                    .replace(/{avgDeposit}/g,          `KES ${Math.round(avgDeposit).toLocaleString()}`)
                    .replace(/{monthsLeft}/g,          monthsRemaining.toString())
                    .replace(/{minimum}/g,             `KES ${MINIMUM_CONTRIBUTION.toLocaleString()}`)
                    .replace(/{gapToMinimum}/g,        `KES ${Math.max(0, MINIMUM_CONTRIBUTION-(memberData.currentMonthTopup||0)).toLocaleString()}`)
                    .replace(/{currentBalance}/g,      `KES ${(memberData.closingBalance||0).toLocaleString()}`)
                    .replace(/{suggestedNextDeposit}/g,`KES ${suggestedNext.toLocaleString()}`)
                    .replace(/{balanceIncrease}/g,     balanceIncrease.toString())
                    .replace(/{percentIncrease}/g,     balanceIncrease.toString())
                    .replace(/{similarMembers}/g,      (Math.floor(Math.random()*5)+3).toString())
                    .replace(/{shareOfTotal}/g,        shareOfTotal.toString())
                    .replace(/{projectedInterest}/g,   `KES ${Math.round(estimatedInterest).toLocaleString()}`)
                    .replace(/{lateStartProjection}/g, `KES ${Math.round(lateStart).toLocaleString()}`)
                    .replace(/\*\*/g, '');
                return { icon: msg.icon, text };
            } catch(e) {
                return { icon: 'ðŸ“Š', text: `You're on track for KES ${Math.round((memberData.closingBalance||0)+40000).toLocaleString()} by December. Keep going!` };
            }
        }

        /* â”€â”€ PASSWORD SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        function PasswordScreen({ onSuccess }) {
            const [password, setPassword] = useState('');
            const [error, setError]       = useState('');
            const [shake, setShake]       = useState(false);
            const handleSubmit = (e) => {
                e.preventDefault();
                if (password === CORRECT_PASSWORD) { setAuthToken(); onSuccess(); }
                else {
                    setError('Incorrect password. Please try again or contact admin.');
                    setShake(true); setTimeout(() => setShake(false), 500); setPassword('');
                }
            };
            return (
                <div className="password-screen">
                    <div className="password-card fade-in" style={{ animation: shake ? 'shake 0.5s' : undefined }}>
                        <span className="password-lock">ðŸ”’</span>
                        <div className="password-title">Like-Minded Folks</div>
                        <div className="password-subtitle">MMF Account Tracker Â· Members Only</div>
                        <form onSubmit={handleSubmit}>
                            <input type="password" value={password} onChange={e => setPassword(e.target.value)}
                                placeholder="Enter password" autoFocus
                                className={`password-input${error ? ' err' : ''}`} />
                            {error && <div className="password-error">âŒ {error}</div>}
                            <button type="submit" className="password-btn">Access Tracker â†’</button>
                        </form>
                        <p className="password-help">Don't have the password?<br/>Contact your group admin</p>
                    </div>
                    <style>{`@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-10px)}75%{transform:translateX(10px)}}`}</style>
                </div>
            );
        }

        function AppWithAuth() {
            const [showTour, setShowTour] = useState(() => !localStorage.getItem('mmf_tour_seen'));
            return <App showTour={showTour} onTourDone={() => { localStorage.setItem('mmf_tour_seen','true'); setShowTour(false); }} />;
        }

        /* â”€â”€ SITE TOUR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        function SiteTour({ onDone, openSidebar, closeSidebar, onSidebarStepChange }) {
            const [step, setStep] = useState(0);
            const [highlightRect, setHighlightRect] = useState(null);
            const tooltipRef = React.useRef(null);
            const TOUR_STEPS = [
                { selector:'.month-selector',           title:'Pick a Month',      text:"Tap any month to view that month's data.", position:'below', sidebar:false },
                { selector:'.view-toggle',              title:'Switch Views',      text:"Member View = your balance. All Members = everyone side by side.", position:'below', sidebar:false },
                { selector:'.alias-selector',           title:'Select Your Alias', text:"Choose your alias to see your personal balance card.", position:'below', sidebar:false },
                { selector:'.sidebar-section:nth-child(2)', title:'Track Activity',  text:"Open the shared tracker to see contribution activity.", position:'below', sidebar:true },
                { selector:'.sidebar-section:nth-child(3)', title:'Make a Deposit',  text:"M-PESA and bank deposit details. Always use 308398M as reference.", position:'below', sidebar:true },
                { selector:'.sidebar-section:nth-child(4)', title:'Group Rules',     text:"Quick reference for contribution minimums and withdrawal policy.", position:'below', sidebar:true },
                { selector:'.sidebar-section:nth-child(5)', title:'Etica Statements',text:"Download official monthly statements from Etica here.", position:'below', sidebar:true }
            ];
            useEffect(() => {
                const isMobile = window.innerWidth <= 968;
                if (isMobile && TOUR_STEPS[step].sidebar) openSidebar(); else if (isMobile) closeSidebar();
                onSidebarStepChange(TOUR_STEPS[step].sidebar);
            }, [step]);
            useEffect(() => {
                const t = setTimeout(positionHighlight, 350);
                window.addEventListener('resize', positionHighlight);
                return () => { clearTimeout(t); window.removeEventListener('resize', positionHighlight); };
            }, [step]);
            function positionHighlight() {
                const el = document.querySelector(TOUR_STEPS[step].selector);
                if (el) { const r = el.getBoundingClientRect(); setHighlightRect({ top:r.top+window.scrollY-6, left:r.left-6, width:r.width+12, height:r.height+12 }); }
            }
            function getTooltipStyle() {
                if (!highlightRect) return { top:'50%', left:'50%', transform:'translate(-50%,-50%)' };
                const base = { left: Math.max(10, Math.min(highlightRect.left, window.innerWidth-300))+'px' };
                if (TOUR_STEPS[step].position === 'below') base.top = (highlightRect.top + highlightRect.height + 14)+'px';
                else base.top = (highlightRect.top - 180)+'px';
                return base;
            }
            const cur = TOUR_STEPS[step]; const isLast = step === TOUR_STEPS.length-1;
            function handleNext() { if (isLast) { closeSidebar(); onSidebarStepChange(false); onDone(); } else setStep(s=>s+1); }
            function handleDone() { closeSidebar(); onSidebarStepChange(false); onDone(); }
            return (
                <>
                    <div className="tour-overlay" onClick={handleDone} />
                    {highlightRect && <div className="tour-highlight" style={{top:highlightRect.top+'px',left:highlightRect.left+'px',width:highlightRect.width+'px',height:highlightRect.height+'px'}} />}
                    <div className="tour-tooltip" style={getTooltipStyle()} ref={tooltipRef}>
                        <div className={`tour-tooltip-arrow arrow-${cur.position==='below'?'top':'bottom'}`} />
                        <div className="tour-step-badge">STEP {step+1} OF {TOUR_STEPS.length}</div>
                        <h4>{cur.title}</h4><p>{cur.text}</p>
                        <div className="tour-controls">
                            <button className="tour-btn-skip" onClick={handleDone}>Skip tour</button>
                            <div style={{display:'flex',alignItems:'center',gap:'12px'}}>
                                <div className="tour-dots">{TOUR_STEPS.map((_,i)=><div key={i} className={`tour-dot${i===step?' active':''}`}/>)}</div>
                                <button className="tour-btn-next" onClick={handleNext}>{isLast?'ðŸŽ‰ Done':'Next â†’'}</button>
                            </div>
                        </div>
                    </div>
                </>
            );
        }

        /* â”€â”€ MAIN APP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        function App({ showTour, onTourDone }) {
            const [data, setData]                   = useState(null);
            const [loading, setLoading]             = useState(true);
            const [error, setError]                 = useState(null);
            const [selectedMonth, setSelectedMonth] = useState(getCurrentMonth());
            const [selectedAlias, setSelectedAlias] = useState('');
            const [view, setView]                   = useState('member');
            const [fileLastModified, setFileLastModified] = useState(null);
            const [mobileMenuOpen, setMobileMenuOpen]     = useState(false);
            const [tourSidebarActive, setTourSidebarActive] = useState(false);

            useEffect(() => { loadDataFromGoogleSheets(); }, []);

            const loadDataFromGoogleSheets = async () => {
                try {
                    setLoading(true); setError(null);
                    const parsedData = {};
                    const results = await Promise.all(MONTHS.map(async month => {
                        const url  = MONTH_CSV_URLS[month];
                        const resp = await fetch(`${url}&_=${Date.now()}`, {
                            cache: 'no-store',
                            headers: { 'Cache-Control': 'no-cache, no-store, must-revalidate', 'Pragma': 'no-cache' }
                        });
                        if (!resp.ok) throw new Error(`Could not load ${month} data`);
                        const text  = await resp.text();
                        const lines = text.split('\n').filter(l => l.trim());
                        const mdata = {};
                        for (let i = 3; i < lines.length; i++) {
                            const cols  = parseCSVLine(lines[i]);
                            const alias = cols[0]?.trim().replace(/"/g,'');
                            if (alias && MEMBERS.includes(alias)) {
                                const n = s => parseFloat((s||'').replace(/["',\s]/g,'')) || 0;
                                mdata[alias] = {
                                    openingBalance: n(cols[1]), topups: n(cols[2]),
                                    interest: n(cols[3]), daysActive: parseInt((cols[4]||'').replace(/[",\s]/g,''))||0,
                                    closingBalance: n(cols[5])
                                };
                            }
                        }
                        return { month, monthData: mdata };
                    }));
                    results.forEach(({ month, monthData }) => { parsedData[month] = monthData; });
                    setData(parsedData); setFileLastModified(new Date()); setLoading(false);
                } catch(err) {
                    console.error(err);
                    setError('Unable to load data from Google Sheets. Please refresh or contact the admin.');
                    setLoading(false);
                }
            };

            const parseCSVLine = (line) => {
                const result = []; let cur = ''; let inQ = false;
                for (const ch of line) {
                    if (ch === '"') inQ = !inQ;
                    else if (ch === ',' && !inQ) { result.push(cur); cur=''; }
                    else cur += ch;
                }
                result.push(cur); return result;
            };

            const getAllMembersData = (month) => MEMBERS.map(alias => ({
                alias, ...(data[month]?.[alias] || { openingBalance:0, topups:0, interest:0, daysActive:0, closingBalance:0 })
            })).sort((a,b) => b.closingBalance - a.closingBalance);

            const calculateGroupStats = () => {
                if (!data || !data[selectedMonth]) return null;
                const members  = getAllMembersData(selectedMonth);
                const monthTopups   = members.reduce((s,m)=>s+m.topups, 0);
                const monthInterest = members.reduce((s,m)=>s+m.interest, 0);
                const totalBalance  = members.reduce((s,m)=>s+m.closingBalance, 0);
                const idx = MONTHS.indexOf(selectedMonth);
                let cumContrib = 0, cumInterest = 0;
                for (let i=0; i<=idx; i++) {
                    if (data[MONTHS[i]]) {
                        const mm = getAllMembersData(MONTHS[i]);
                        cumContrib  += mm.reduce((s,m)=>s+m.topups, 0);
                        cumInterest += mm.reduce((s,m)=>s+m.interest, 0);
                    }
                }
                return { monthTopups, monthInterest, cumulativeContributions:cumContrib, cumulativeInterest:cumInterest, totalAmount:cumContrib+cumInterest, totalBalance };
            };

            const isCurrentMonth   = m => m === getCurrentMonth();
            const shouldShowWarnings = () => new Date().getDate() >= WARNING_START_DAY;

            if (loading) return (
                <div className="app-layout"><div className="main-content"><div className="loading"><div className="loading-spinner"/><div className="loading-text">Loading your dataâ€¦</div></div></div></div>
            );
            if (error) return (
                <div className="app-layout"><div className="main-content"><div className="error"><p>{error}</p><button className="btn-secondary" onClick={loadDataFromGoogleSheets}>â†º Retry</button></div></div></div>
            );

            const stats = calculateGroupStats();
            return (
                <>
                    <div className="app-layout">
                        {/* SIDEBAR */}
                        <aside className={`sidebar${mobileMenuOpen?' mobile-open':''}`} style={tourSidebarActive?{zIndex:10001}:{}}>
                            <div className="sidebar-close"><button onClick={()=>setMobileMenuOpen(false)}>âœ• Close</button></div>
                            <div className="sidebar-logo">
                                <div className="sidebar-logo-icon">ðŸ’°</div>
                                <div><div className="sidebar-logo-text">Like-Minded Folks</div><div className="sidebar-logo-sub">MMF Account Tracker</div></div>
                            </div>

                            <div className="sidebar-section">
                                <h3>ðŸ“Š Activity</h3>
                                <a href="#" className="sidebar-link" onClick={(e)=>{
                                    e.preventDefault();
                                    const b64='PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAsIHVzZXItc2NhbGFibGU9bm8iPgogICAgPHRpdGxlPkxNRiBDb250cmlidXRpb24vRGVwb3NpdCBUcmFja2VyPC90aXRsZT4KICAgIDxzdHlsZT4KICAgICAgICAqIHsKICAgICAgICAgICAgbWFyZ2luOiAwOwogICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgICAgIH0KICAgICAgICAKICAgICAgICBib2R5IHsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgQXJpYWwsIHNhbnMtc2VyaWY7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuMzsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZmZjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgI2xvYWRpbmcgewogICAgICAgICAgICBwYWRkaW5nOiAyMHB4OwogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgICAgIGNvbG9yOiAjNjY2OwogICAgICAgIH0KICAgICAgICAKICAgICAgICAjZXJyb3IgewogICAgICAgICAgICBwYWRkaW5nOiAyMHB4OwogICAgICAgICAgICBjb2xvcjogI2QzMmYyZjsKICAgICAgICAgICAgZGlzcGxheTogbm9uZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLnRhYmxlLWNvbnRhaW5lciB7CiAgICAgICAgICAgIHdpZHRoOiAxMDB2dzsKICAgICAgICAgICAgaGVpZ2h0OiAxMDB2aDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGF1dG87CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHRhYmxlIHsKICAgICAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsKICAgICAgICAgICAgd2lkdGg6IG1heC1jb250ZW50OwogICAgICAgICAgICBmb250LXNpemU6IDExcHg7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHRoLCB0ZCB7CiAgICAgICAgICAgIHBhZGRpbmc6IDRweCAzcHg7CiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgICAgICAgYm9yZGVyOiAwLjVweCBzb2xpZCAjZDBkMGQwOwogICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICAgICAgICBmb250LXNpemU6IDExcHg7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8qIEluY3JlYXNlIGZvbnQgc2l6ZSBmb3IgZGF0YSByb3dzICh0Ym9keSkgKi8KICAgICAgICB0Ym9keSB0ZCB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTNweDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogRmlyc3QgdGhyZWUgY29sdW1ucyAtIGZyb3plbiBhbmQgY29tcGFjdCAqLwogICAgICAgIHRoOm50aC1jaGlsZCgxKSwKICAgICAgICB0ZDpudGgtY2hpbGQoMSkgewogICAgICAgICAgICBwb3NpdGlvbjogc3RpY2t5OwogICAgICAgICAgICBsZWZ0OiAwOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZmFmYWZhOwogICAgICAgICAgICB6LWluZGV4OiA1OwogICAgICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0OwogICAgICAgICAgICB3aWR0aDogYXV0bzsKICAgICAgICAgICAgbWluLXdpZHRoOiAzMHB4OwogICAgICAgICAgICBtYXgtd2lkdGg6IDV2dzsKICAgICAgICAgICAgZm9udC1zaXplOiAxMXB4OwogICAgICAgICAgICBwYWRkaW5nOiA0cHggM3B4OwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvKiBJbmNyZWFzZSBmb250IHNpemUgZm9yIHRib2R5IGNlbGxzIGluIGNvbHVtbiAxICovCiAgICAgICAgdGJvZHkgdGQ6bnRoLWNoaWxkKDEpIHsKICAgICAgICAgICAgZm9udC1zaXplOiAxM3B4OwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0aDpudGgtY2hpbGQoMiksCiAgICAgICAgdGQ6bnRoLWNoaWxkKDIpIHsKICAgICAgICAgICAgcG9zaXRpb246IHN0aWNreTsKICAgICAgICAgICAgbGVmdDogdmFyKC0tY29sMS13aWR0aCwgNXZ3KTsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZhZmFmYTsKICAgICAgICAgICAgei1pbmRleDogNTsKICAgICAgICAgICAgdGV4dC1hbGlnbjogbGVmdDsKICAgICAgICAgICAgd2lkdGg6IGF1dG87CiAgICAgICAgICAgIG1pbi13aWR0aDogODBweDsKICAgICAgICAgICAgbWF4LXdpZHRoOiAxNnZ3OwogICAgICAgICAgICBmb250LXNpemU6IDExcHg7CiAgICAgICAgICAgIHBhZGRpbmc6IDRweCAzcHg7CiAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3JtYWw7CiAgICAgICAgICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuMzsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogSW5jcmVhc2UgZm9udCBzaXplIGZvciB0Ym9keSBjZWxscyBpbiBjb2x1bW4gMiAqLwogICAgICAgIHRib2R5IHRkOm50aC1jaGlsZCgyKSB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTNweDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdGg6bnRoLWNoaWxkKDMpLAogICAgICAgIHRkOm50aC1jaGlsZCgzKSB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBzdGlja3k7CiAgICAgICAgICAgIGxlZnQ6IHZhcigtLWNvbDItd2lkdGgsIDIxdncpOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZmFmYWZhOwogICAgICAgICAgICB6LWluZGV4OiA1OwogICAgICAgICAgICB0ZXh0LWFsaWduOiByaWdodDsKICAgICAgICAgICAgd2lkdGg6IGF1dG87CiAgICAgICAgICAgIG1pbi13aWR0aDogODBweDsKICAgICAgICAgICAgbWF4LXdpZHRoOiBjYWxjKDMzLjMzdncgLSB2YXIoLS1jb2wxLXdpZHRoLCA1dncpIC0gdmFyKC0tY29sMi13aWR0aCwgMjF2dykgKyA1dncgKyAxNnZ3KTsKICAgICAgICAgICAgZm9udC1zaXplOiAxMXB4OwogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsKICAgICAgICAgICAgcGFkZGluZzogNHB4IDNweDsKICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8qIEluY3JlYXNlIGZvbnQgc2l6ZSBmb3IgdGJvZHkgY2VsbHMgaW4gY29sdW1uIDMgKi8KICAgICAgICB0Ym9keSB0ZDpudGgtY2hpbGQoMykgewogICAgICAgICAgICBmb250LXNpemU6IDEzcHg7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8qIEhlYWRlciByb3dzIHN0aWNreSAqLwogICAgICAgIHRoZWFkIHRyIHRoIHsKICAgICAgICAgICAgcG9zaXRpb246IHN0aWNreTsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2Y1ZjVmNTsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICAgICAgei1pbmRleDogMTA7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8qIEZpcnN0IHRocmVlIGNvbHVtbiBoZWFkZXJzIGhpZ2hlciB6LWluZGV4ICovCiAgICAgICAgdGhlYWQgdHIgdGg6bnRoLWNoaWxkKDEpLAogICAgICAgIHRoZWFkIHRyIHRoOm50aC1jaGlsZCgyKSwKICAgICAgICB0aGVhZCB0ciB0aDpudGgtY2hpbGQoMykgewogICAgICAgICAgICB6LWluZGV4OiAxNTsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZhZmFmYTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogUm93IDEgLSBXZWVrIG51bWJlcnMgKi8KICAgICAgICB0aGVhZCB0cjpudGgtY2hpbGQoMSkgdGggewogICAgICAgICAgICB0b3A6IDA7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTBweDsKICAgICAgICAgICAgcGFkZGluZzogNHB4IDNweDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogUm93IDIgLSBNb250aHMgKG1lcmdlZCBjZWxscykgKi8KICAgICAgICB0aGVhZCB0cjpudGgtY2hpbGQoMikgdGggewogICAgICAgICAgICB0b3A6IDI0cHg7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTBweDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICAgICAgcGFkZGluZzogNHB4IDNweDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogUm93IDMgLSBEYXRlcyB3aXRoIHdyYXBwaW5nICovCiAgICAgICAgdGhlYWQgdHI6bnRoLWNoaWxkKDMpIHRoIHsKICAgICAgICAgICAgdG9wOiA0OHB4OwogICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm9ybWFsOwogICAgICAgICAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTBweDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuMjsKICAgICAgICAgICAgcGFkZGluZzogNHB4IDJweDsKICAgICAgICAgICAgaGVpZ2h0OiAzNnB4OwogICAgICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMDA0MjNlICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogRGF0ZSByb3cgLSBmaXJzdCB0aHJlZSBjb2x1bW5zIGFsc28gZ2V0IHRoZSBjb2xvciAqLwogICAgICAgIHRoZWFkIHRyOm50aC1jaGlsZCgzKSB0aDpudGgtY2hpbGQoMSksCiAgICAgICAgdGhlYWQgdHI6bnRoLWNoaWxkKDMpIHRoOm50aC1jaGlsZCgyKSwKICAgICAgICB0aGVhZCB0cjpudGgtY2hpbGQoMykgdGg6bnRoLWNoaWxkKDMpIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzAwNDIzZSAhaW1wb3J0YW50OwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvKiBCYW5kZWQgcm93cyAtIGFsdGVybmF0aW5nIGNvbG9ycyAqLwogICAgICAgIHRib2R5IHRyOm50aC1jaGlsZChldmVuKSB0ZCB7CiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNkY2U2ZjE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHRib2R5IHRyOm50aC1jaGlsZChvZGQpIHRkIHsKICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y5ZjlmOTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogQXBwbHkgYmFuZGVkIGNvbG9ycyB0byBmcm96ZW4gY29sdW1ucyB0b28gKi8KICAgICAgICB0Ym9keSB0cjpudGgtY2hpbGQoZXZlbikgdGQ6bnRoLWNoaWxkKDEpLAogICAgICAgIHRib2R5IHRyOm50aC1jaGlsZChldmVuKSB0ZDpudGgtY2hpbGQoMiksCiAgICAgICAgdGJvZHkgdHI6bnRoLWNoaWxkKGV2ZW4pIHRkOm50aC1jaGlsZCgzKSB7CiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNkY2U2ZjE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHRib2R5IHRyOm50aC1jaGlsZChvZGQpIHRkOm50aC1jaGlsZCgxKSwKICAgICAgICB0Ym9keSB0cjpudGgtY2hpbGQob2RkKSB0ZDpudGgtY2hpbGQoMiksCiAgICAgICAgdGJvZHkgdHI6bnRoLWNoaWxkKG9kZCkgdGQ6bnRoLWNoaWxkKDMpIHsKICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y5ZjlmOTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogTnVtYmVyIGFsaWdubWVudCBhbmQgZm9ybWF0dGluZyAqLwogICAgICAgIHRkLm51bWJlciB7CiAgICAgICAgICAgIHRleHQtYWxpZ246IHJpZ2h0OwogICAgICAgICAgICBmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvKiBUT1RBTCByb3cgc3R5bGluZyAqLwogICAgICAgIHRib2R5IHRyLnRvdGFsLXJvdyB0ZCB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMwMDIzNTEgIWltcG9ydGFudDsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsKICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvKiBDb21wYWN0IGRhdGEgY29sdW1ucyAqLwogICAgICAgIHRoOm5vdCg6bnRoLWNoaWxkKDEpKTpub3QoOm50aC1jaGlsZCgyKSk6bm90KDpudGgtY2hpbGQoMykpLAogICAgICAgIHRkOm5vdCg6bnRoLWNoaWxkKDEpKTpub3QoOm50aC1jaGlsZCgyKSk6bm90KDpudGgtY2hpbGQoMykpIHsKICAgICAgICAgICAgbWluLXdpZHRoOiA1MHB4OwogICAgICAgICAgICBtYXgtd2lkdGg6IDY1cHg7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTFweDsKICAgICAgICAgICAgcGFkZGluZzogNHB4IDNweDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogSW5jcmVhc2UgZm9udCBzaXplIGZvciB0Ym9keSBkYXRhIGNlbGxzICovCiAgICAgICAgdGJvZHkgdGQ6bm90KDpudGgtY2hpbGQoMSkpOm5vdCg6bnRoLWNoaWxkKDIpKTpub3QoOm50aC1jaGlsZCgzKSkgewogICAgICAgICAgICBmb250LXNpemU6IDEzcHg7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8qIExvYWRpbmcgc3Bpbm5lciAqLwogICAgICAgIC5zcGlubmVyIHsKICAgICAgICAgICAgYm9yZGVyOiAzcHggc29saWQgI2YzZjNmMzsKICAgICAgICAgICAgYm9yZGVyLXRvcDogM3B4IHNvbGlkICMzNDk4ZGI7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgd2lkdGg6IDMwcHg7CiAgICAgICAgICAgIGhlaWdodDogMzBweDsKICAgICAgICAgICAgYW5pbWF0aW9uOiBzcGluIDFzIGxpbmVhciBpbmZpbml0ZTsKICAgICAgICAgICAgbWFyZ2luOiAyMHB4IGF1dG87CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBrZXlmcmFtZXMgc3BpbiB7CiAgICAgICAgICAgIDAlIHsgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7IH0KICAgICAgICAgICAgMTAwJSB7IHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7IH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogSGVhZGVyIHRpdGxlICovCiAgICAgICAgLnBhZ2UtaGVhZGVyIHsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBwYWRkaW5nOiAxNXB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMDA0MjNlOwogICAgICAgICAgICBjb2xvcjogd2hpdGU7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMThweDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgICAgIHBvc2l0aW9uOiBzdGlja3k7CiAgICAgICAgICAgIHRvcDogMDsKICAgICAgICAgICAgei1pbmRleDogMjA7CiAgICAgICAgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICAgIDxkaXYgY2xhc3M9InBhZ2UtaGVhZGVyIj5MTUYgQ29udHJpYnV0aW9uL0RlcG9zaXQgVHJhY2tlcjwvZGl2PgogICAgPGRpdiBpZD0ibG9hZGluZyI+CiAgICAgICAgPGRpdiBjbGFzcz0ic3Bpbm5lciI+PC9kaXY+CiAgICAgICAgPHA+TG9hZGluZyBkYXRhLi4uPC9wPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSJlcnJvciI+PC9kaXY+CiAgICA8ZGl2IGlkPSJ0YWJsZUNvbnRhaW5lciIgY2xhc3M9InRhYmxlLWNvbnRhaW5lciIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij48L2Rpdj4KCiAgICA8c2NyaXB0PgogICAgICAgIGNvbnN0IENTVl9VUkwgPSAnaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlFmUWRCVmwwMWN4c0lvR25mSkxsdEdEdU9rSVZERnFqLXJOZzNLd0ZWWjgtR0diVXFrMURTc19DVmF5Z2lzamFMaGczMGcxZ2p6SXNkQy9wdWI/Z2lkPTIwNzk0NTMwMTYmc2luZ2xlPXRydWUmb3V0cHV0PWNzdic7CiAgICAgICAgCiAgICAgICAgZnVuY3Rpb24gcGFyc2VDU1YodGV4dCkgewogICAgICAgICAgICBjb25zdCBsaW5lcyA9IFtdOwogICAgICAgICAgICBsZXQgY3VycmVudExpbmUgPSBbXTsKICAgICAgICAgICAgbGV0IGN1cnJlbnRGaWVsZCA9ICcnOwogICAgICAgICAgICBsZXQgaW5RdW90ZXMgPSBmYWxzZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgY2hhciA9IHRleHRbaV07CiAgICAgICAgICAgICAgICBjb25zdCBuZXh0Q2hhciA9IHRleHRbaSArIDFdOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAoY2hhciA9PT0gJyInKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGluUXVvdGVzICYmIG5leHRDaGFyID09PSAnIicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpZWxkICs9ICciJzsKICAgICAgICAgICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluUXVvdGVzID0gIWluUXVvdGVzOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gJywnICYmICFpblF1b3RlcykgewogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRMaW5lLnB1c2goY3VycmVudEZpZWxkKTsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50RmllbGQgPSAnJzsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGNoYXIgPT09ICdcbicgfHwgY2hhciA9PT0gJ1xyJykgJiYgIWluUXVvdGVzKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRGaWVsZCB8fCBjdXJyZW50TGluZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRMaW5lLnB1c2goY3VycmVudEZpZWxkKTsKICAgICAgICAgICAgICAgICAgICAgICAgbGluZXMucHVzaChjdXJyZW50TGluZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRMaW5lID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGaWVsZCA9ICcnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoY2hhciA9PT0gJ1xyJyAmJiBuZXh0Q2hhciA9PT0gJ1xuJykgewogICAgICAgICAgICAgICAgICAgICAgICBpKys7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50RmllbGQgKz0gY2hhcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGN1cnJlbnRGaWVsZCB8fCBjdXJyZW50TGluZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50TGluZS5wdXNoKGN1cnJlbnRGaWVsZCk7CiAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGN1cnJlbnRMaW5lKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIGxpbmVzOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBmdW5jdGlvbiBpc051bWVyaWModmFsdWUpIHsKICAgICAgICAgICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZS50cmltKCkgPT09ICcnKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIGNvbnN0IG51bSA9IHZhbHVlLnJlcGxhY2UoLywvZywgJycpOwogICAgICAgICAgICByZXR1cm4gIWlzTmFOKG51bSkgJiYgIWlzTmFOKHBhcnNlRmxvYXQobnVtKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGZ1bmN0aW9uIGZvcm1hdE51bWJlcih2YWx1ZSkgewogICAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUZsb2F0KHZhbHVlLnJlcGxhY2UoLywvZywgJycpKTsKICAgICAgICAgICAgaWYgKGlzTmFOKG51bSkpIHJldHVybiB2YWx1ZTsKICAgICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQobnVtKS50b0xvY2FsZVN0cmluZygnZW4tVVMnKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZnVuY3Rpb24gY3JlYXRlVGFibGUoZGF0YSkgewogICAgICAgICAgICBpZiAoIWRhdGEgfHwgZGF0YS5sZW5ndGggPCA1KSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vdCBlbm91Z2ggZGF0YSBmb3VuZCcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBTa2lwIGZpcnN0IDQgcm93cwogICAgICAgICAgICAvLyBSb3cgNSAoaW5kZXggNCkgPSBXZWVrIG51bWJlcnMKICAgICAgICAgICAgLy8gUm93IDYgKGluZGV4IDUpID0gTW9udGhzCiAgICAgICAgICAgIC8vIFJvdyA3IChpbmRleCA2KSA9IERhdGVzCiAgICAgICAgICAgIGNvbnN0IHdlZWtSb3cgPSBkYXRhWzRdOwogICAgICAgICAgICBjb25zdCBtb250aFJvdyA9IGRhdGFbNV07CiAgICAgICAgICAgIGNvbnN0IGRhdGVSb3cgPSBkYXRhWzZdOwogICAgICAgICAgICBjb25zdCBkYXRhUm93cyA9IGRhdGEuc2xpY2UoNykuZmlsdGVyKHJvdyA9PiByb3cuc29tZShjZWxsID0+IGNlbGwgJiYgY2VsbC50cmltKCkpKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGFibGUnKTsKICAgICAgICAgICAgY29uc3QgdGhlYWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aGVhZCcpOwogICAgICAgICAgICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3Rib2R5Jyk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBDcmVhdGUgd2VlayBudW1iZXIgcm93CiAgICAgICAgICAgIGNvbnN0IHdlZWtUciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7CiAgICAgICAgICAgIC8vIEFkZCBibGFuayBjZWxscyBmb3IgZmlyc3QgdGhyZWUgY29sdW1ucwogICAgICAgICAgICBjb25zdCBibGFua1dlZWsxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGgnKTsKICAgICAgICAgICAgY29uc3QgYmxhbmtXZWVrMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RoJyk7CiAgICAgICAgICAgIGNvbnN0IGJsYW5rV2VlazMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpOwogICAgICAgICAgICBibGFua1dlZWszLnRleHRDb250ZW50ID0gJ1dFRUsgTk8uJzsKICAgICAgICAgICAgYmxhbmtXZWVrMy5zdHlsZS5jb2xvciA9ICdibGFjayc7CiAgICAgICAgICAgIGJsYW5rV2VlazMuc3R5bGUuZm9udFdlaWdodCA9ICdib2xkJzsKICAgICAgICAgICAgd2Vla1RyLmFwcGVuZENoaWxkKGJsYW5rV2VlazEpOwogICAgICAgICAgICB3ZWVrVHIuYXBwZW5kQ2hpbGQoYmxhbmtXZWVrMik7CiAgICAgICAgICAgIHdlZWtUci5hcHBlbmRDaGlsZChibGFua1dlZWszKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAzOyBpIDwgd2Vla1Jvdy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpOwogICAgICAgICAgICAgICAgdGgudGV4dENvbnRlbnQgPSB3ZWVrUm93W2ldIHx8ICcnOwogICAgICAgICAgICAgICAgd2Vla1RyLmFwcGVuZENoaWxkKHRoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGVhZC5hcHBlbmRDaGlsZCh3ZWVrVHIpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ3JlYXRlIG1vbnRoIHJvdyB3aXRoIG1lcmdlZCBjZWxscwogICAgICAgICAgICBjb25zdCBtb250aFRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsKICAgICAgICAgICAgLy8gQWRkIGJsYW5rIGNlbGxzIGZvciBmaXJzdCB0aHJlZSBjb2x1bW5zCiAgICAgICAgICAgIGNvbnN0IGJsYW5rTW9udGgxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGgnKTsKICAgICAgICAgICAgY29uc3QgYmxhbmtNb250aDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpOwogICAgICAgICAgICBjb25zdCBibGFua01vbnRoMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RoJyk7CiAgICAgICAgICAgIGJsYW5rTW9udGgzLnRleHRDb250ZW50ID0gJ01PTlRIJzsKICAgICAgICAgICAgYmxhbmtNb250aDMuc3R5bGUuY29sb3IgPSAnYmxhY2snOwogICAgICAgICAgICBibGFua01vbnRoMy5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnOwogICAgICAgICAgICBtb250aFRyLmFwcGVuZENoaWxkKGJsYW5rTW9udGgxKTsKICAgICAgICAgICAgbW9udGhUci5hcHBlbmRDaGlsZChibGFua01vbnRoMik7CiAgICAgICAgICAgIG1vbnRoVHIuYXBwZW5kQ2hpbGQoYmxhbmtNb250aDMpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gVHJhY2sgbWVyZ2VkIG1vbnRoIGNlbGxzCiAgICAgICAgICAgIGxldCBpID0gMzsKICAgICAgICAgICAgd2hpbGUgKGkgPCBtb250aFJvdy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1vbnRoVmFsdWUgPSBtb250aFJvd1tpXSB8fCAnJzsKICAgICAgICAgICAgICAgIGxldCBjb2xzcGFuID0gMTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gQ291bnQgY29uc2VjdXRpdmUgY2VsbHMgd2l0aCBzYW1lIG1vbnRoCiAgICAgICAgICAgICAgICB3aGlsZSAoaSArIGNvbHNwYW4gPCBtb250aFJvdy5sZW5ndGggJiYgbW9udGhSb3dbaSArIGNvbHNwYW5dID09PSBtb250aFZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgY29sc3BhbisrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCB0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RoJyk7CiAgICAgICAgICAgICAgICB0aC50ZXh0Q29udGVudCA9IG1vbnRoVmFsdWU7CiAgICAgICAgICAgICAgICBpZiAoY29sc3BhbiA+IDEpIHsKICAgICAgICAgICAgICAgICAgICB0aC5zZXRBdHRyaWJ1dGUoJ2NvbHNwYW4nLCBjb2xzcGFuKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG1vbnRoVHIuYXBwZW5kQ2hpbGQodGgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpICs9IGNvbHNwYW47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhlYWQuYXBwZW5kQ2hpbGQobW9udGhUcik7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBDcmVhdGUgZGF0ZSByb3cKICAgICAgICAgICAgY29uc3QgZGF0ZVRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsKICAgICAgICAgICAgLy8gQWRkIGJsYW5rIGNlbGxzIGZvciBmaXJzdCB0aHJlZSBjb2x1bW5zCiAgICAgICAgICAgIGNvbnN0IGJsYW5rRGF0ZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpOwogICAgICAgICAgICBjb25zdCBibGFua0RhdGUyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGgnKTsKICAgICAgICAgICAgY29uc3QgYmxhbmtEYXRlMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RoJyk7CiAgICAgICAgICAgIGJsYW5rRGF0ZTMudGV4dENvbnRlbnQgPSAnVE9UQUwnOwogICAgICAgICAgICBibGFua0RhdGUzLnN0eWxlLmNvbG9yID0gJ3doaXRlJzsKICAgICAgICAgICAgYmxhbmtEYXRlMy5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnOwogICAgICAgICAgICBkYXRlVHIuYXBwZW5kQ2hpbGQoYmxhbmtEYXRlMSk7CiAgICAgICAgICAgIGRhdGVUci5hcHBlbmRDaGlsZChibGFua0RhdGUyKTsKICAgICAgICAgICAgZGF0ZVRyLmFwcGVuZENoaWxkKGJsYW5rRGF0ZTMpOwogICAgICAgICAgICAKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDM7IGkgPCBkYXRlUm93Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBjb25zdCB0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RoJyk7CiAgICAgICAgICAgICAgICB0aC50ZXh0Q29udGVudCA9IGRhdGVSb3dbaV0gfHwgJyc7CiAgICAgICAgICAgICAgICBkYXRlVHIuYXBwZW5kQ2hpbGQodGgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoZWFkLmFwcGVuZENoaWxkKGRhdGVUcik7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBDcmVhdGUgZGF0YSByb3dzCiAgICAgICAgICAgIGRhdGFSb3dzLmZvckVhY2gocm93ID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIFRPVEFMIHJvdyAobG9vayBmb3IgIlRPVEFMIiBpbiBmaXJzdCBvciBzZWNvbmQgY29sdW1uKQogICAgICAgICAgICAgICAgY29uc3QgaXNUb3RhbCA9IChyb3dbMF0gJiYgcm93WzBdLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoJ1RPVEFMJykpIHx8IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJvd1sxXSAmJiByb3dbMV0udG9VcHBlckNhc2UoKS5pbmNsdWRlcygnVE9UQUwnKSk7CiAgICAgICAgICAgICAgICBpZiAoaXNUb3RhbCkgewogICAgICAgICAgICAgICAgICAgIHRyLmNsYXNzTGlzdC5hZGQoJ3RvdGFsLXJvdycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE1hdGgubWF4KHJvdy5sZW5ndGgsIHdlZWtSb3cubGVuZ3RoKTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpOwogICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IHJvd1tpXSB8fCAnJzsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBDb2x1bW4gMSAtIHRleHQgb25seQogICAgICAgICAgICAgICAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRkLnRleHRDb250ZW50ID0gdmFsdWU7CiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICAvLyBDb2x1bW4gMiAtIHRleHQgd2l0aCB3cmFwcGluZyBhZnRlciAiLyIKICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpID09PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5pbmNsdWRlcygnLycpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoJy8nLCAnL1xuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdGQudGV4dENvbnRlbnQgPSB2YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGQuc3R5bGUud2hpdGVTcGFjZSA9ICdwcmUtbGluZSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIENvbHVtbiAzIC0gbnVtYmVycyB3aXRoIGNvbW1hcywgbm8gZGVjaW1hbHMsIGJvbGQsIHJpZ2h0LWFsaWduZWQKICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpID09PSAyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc051bWVyaWModmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZC50ZXh0Q29udGVudCA9IGZvcm1hdE51bWJlcih2YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZC50ZXh0Q29udGVudCA9IHZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJpZ2h0LWFsaWduZWQgYW5kIGJvbGQgKGFscmVhZHkgc3R5bGVkIGluIENTUykKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXIgY29sdW1ucyAtIGNoZWNrIGlmIG51bWVyaWMKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTnVtZXJpYyh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRkLnRleHRDb250ZW50ID0gZm9ybWF0TnVtYmVyKHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRkLmNsYXNzTGlzdC5hZGQoJ251bWJlcicpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGQudGV4dENvbnRlbnQgPSB2YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB0ci5hcHBlbmRDaGlsZCh0ZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZCh0cik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgdGFibGUuYXBwZW5kQ2hpbGQodGhlYWQpOwogICAgICAgICAgICB0YWJsZS5hcHBlbmRDaGlsZCh0Ym9keSk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFibGVDb250YWluZXInKTsKICAgICAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9ICcnOwogICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGFibGUpOwogICAgICAgICAgICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBkeW5hbWljIHdpZHRocyBmb3IgZmlyc3QgdGhyZWUgY29sdW1ucwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGNvbDFDZWxscyA9IHRhYmxlLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkOm50aC1jaGlsZCgxKSwgdGg6bnRoLWNoaWxkKDEpJyk7CiAgICAgICAgICAgICAgICBjb25zdCBjb2wyQ2VsbHMgPSB0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCd0ZDpudGgtY2hpbGQoMiksIHRoOm50aC1jaGlsZCgyKScpOwogICAgICAgICAgICAgICAgY29uc3QgY29sM0NlbGxzID0gdGFibGUucXVlcnlTZWxlY3RvckFsbCgndGQ6bnRoLWNoaWxkKDMpLCB0aDpudGgtY2hpbGQoMyknKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbGV0IG1heENvbDEgPSAwOwogICAgICAgICAgICAgICAgbGV0IG1heENvbDIgPSAwOwogICAgICAgICAgICAgICAgbGV0IG1heENvbDMgPSAwOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb2wxQ2VsbHMuZm9yRWFjaChjZWxsID0+IG1heENvbDEgPSBNYXRoLm1heChtYXhDb2wxLCBjZWxsLnNjcm9sbFdpZHRoKSk7CiAgICAgICAgICAgICAgICBjb2wyQ2VsbHMuZm9yRWFjaChjZWxsID0+IG1heENvbDIgPSBNYXRoLm1heChtYXhDb2wyLCBjZWxsLnNjcm9sbFdpZHRoKSk7CiAgICAgICAgICAgICAgICBjb2wzQ2VsbHMuZm9yRWFjaChjZWxsID0+IG1heENvbDMgPSBNYXRoLm1heChtYXhDb2wzLCBjZWxsLnNjcm9sbFdpZHRoKSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIEFkZCBzb21lIHBhZGRpbmcKICAgICAgICAgICAgICAgIG1heENvbDEgKz0gODsKICAgICAgICAgICAgICAgIG1heENvbDIgKz0gODsKICAgICAgICAgICAgICAgIG1heENvbDMgKz0gODsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gRW5zdXJlIHRvdGFsIGRvZXNuJ3QgZXhjZWVkIDMzLjMzdncKICAgICAgICAgICAgICAgIGNvbnN0IG1heFRvdGFsID0gd2luZG93LmlubmVyV2lkdGggKiAwLjMzMzM7CiAgICAgICAgICAgICAgICBjb25zdCB0b3RhbCA9IG1heENvbDEgKyBtYXhDb2wyICsgbWF4Q29sMzsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKHRvdGFsID4gbWF4VG90YWwpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzY2FsZSA9IG1heFRvdGFsIC8gdG90YWw7CiAgICAgICAgICAgICAgICAgICAgbWF4Q29sMSAqPSBzY2FsZTsKICAgICAgICAgICAgICAgICAgICBtYXhDb2wyICo9IHNjYWxlOwogICAgICAgICAgICAgICAgICAgIG1heENvbDMgKj0gc2NhbGU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgd2lkdGhzCiAgICAgICAgICAgICAgICBjb2wxQ2VsbHMuZm9yRWFjaChjZWxsID0+IGNlbGwuc3R5bGUud2lkdGggPSBtYXhDb2wxICsgJ3B4Jyk7CiAgICAgICAgICAgICAgICBjb2wyQ2VsbHMuZm9yRWFjaChjZWxsID0+IHsKICAgICAgICAgICAgICAgICAgICBjZWxsLnN0eWxlLndpZHRoID0gbWF4Q29sMiArICdweCc7CiAgICAgICAgICAgICAgICAgICAgY2VsbC5zdHlsZS5sZWZ0ID0gbWF4Q29sMSArICdweCc7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGNvbDNDZWxscy5mb3JFYWNoKGNlbGwgPT4gewogICAgICAgICAgICAgICAgICAgIGNlbGwuc3R5bGUud2lkdGggPSBtYXhDb2wzICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICBjZWxsLnN0eWxlLmxlZnQgPSAobWF4Q29sMSArIG1heENvbDIpICsgJ3B4JzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9LCAxMDApOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBhc3luYyBmdW5jdGlvbiBsb2FkRGF0YSgpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goQ1NWX1VSTCk7CiAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2g6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7CiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gcGFyc2VDU1YodGV4dCk7CiAgICAgICAgICAgICAgICBjcmVhdGVUYWJsZShkYXRhKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgZGF0YTonLCBlcnJvcik7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBjb25zdCBlcnJvckRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvcicpOwogICAgICAgICAgICAgICAgZXJyb3JEaXYudGV4dENvbnRlbnQgPSBgRXJyb3IgbG9hZGluZyBkYXRhOiAke2Vycm9yLm1lc3NhZ2V9LiBQdWxsIGRvd24gdG8gcmVmcmVzaC5gOwogICAgICAgICAgICAgICAgZXJyb3JEaXYuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gTG9hZCBkYXRhIG9uIHBhZ2UgbG9hZAogICAgICAgIGxvYWREYXRhKCk7CiAgICA8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==';
                                    const bytes=atob(b64);
                                    const arr=new Uint8Array(bytes.length);
                                    for(let i=0;i<bytes.length;i++) arr[i]=bytes.charCodeAt(i);
                                    const blob=new Blob([arr],{type:'text/html'});
                                    const url=URL.createObjectURL(blob);
                                    window.open(url,'_blank');
                                }}>View Contributions â†—</a>
                            </div>

                            <div className="sidebar-section">
                                <h3>ðŸ’³ Make a Deposit</h3>
                                <div className="deposit-method">
                                    <div className="deposit-title">M-PESA</div>
                                    <div className="deposit-info">Paybill: <strong>4096483</strong><br/>Account: <strong>308398M</strong></div>
                                </div>
                                <div className="deposit-method">
                                    <div className="deposit-title">Bank Transfer</div>
                                    <div className="deposit-info">Bank: <strong>Equity Bank</strong><br/>A/C Name: Etica Unit Trust Collection<br/>A/C No: <strong>0180 28395 1027</strong><br/>Reference: <strong>308398M</strong></div>
                                    <div className="deposit-warn">âš ï¸ <strong>Important:</strong> Always write <strong>308398M</strong> in the Reference/Remarks section</div>
                                </div>
                            </div>

                            <div className="sidebar-section">
                                <h3>ðŸ“œ Rules</h3>
                                <ul className="rules-list">
                                    <li>Min. contribution: <strong>KES 4,000/month</strong></li>
                                    <li>Interest only with minimum contribution</li>
                                    <li>Withdrawals: December (before Week 3)</li>
                                    <li>Fund: <strong>Etica MMF</strong></li>
                                    <li>Max members: <strong>15</strong></li>
                                </ul>
                            </div>

                            <div className="sidebar-section">
                                <h3>ðŸ“„ Etica Statements</h3>
                                <div className="pdf-password">Password: 308398</div>
                                <select className="statements-dropdown" onChange={(e) => {
                                    if (!e.target.value) return;
                                    const sel = e.target.value;
                                    const url = `${sel}_${CURRENT_YEAR}_Statement.pdf`;
                                    fetch(url,{method:'HEAD', cache:'no-store'}).then(r => {
                                        if (r.ok) window.open(url,'_blank');
                                        else {
                                            const msgs = [
                                                `ðŸ“Š The ${sel} statement is still cookingâ€¦ Check back soon! ðŸ³`,
                                                `â³ ${sel}'s numbers are being crunchedâ€¦ Almost ready! ðŸ§®`,
                                                `ðŸŽ¬ ${sel} statement: Coming soon! ðŸŽ¥`,
                                                `ðŸ“ Dotting the i's on ${sel}â€¦ Patience! âœï¸`,
                                                `â° ${sel} statement: Under construction! ðŸ‘·`
                                            ];
                                            alert(msgs[Math.floor(Math.random()*msgs.length)]);
                                        }
                                    }).catch(()=>window.open(url,'_blank'));
                                    e.target.value='';
                                }}>
                                    <option value="">ðŸ“¥ Select Month to Download</option>
                                    {MONTHS.map(m=><option key={m} value={m} style={{background:'#131320',color:'#f0f0f8'}}>{m}</option>)}
                                </select>
                            </div>
                        </aside>

                        {/* MAIN CONTENT */}
                        <main className="main-content">
                            <div className="header">
                                <div className="header-eyebrow">MMF Account Tracker Â· {CURRENT_YEAR}</div>
                                <h1>Like-Minded Folks</h1>
                                <div className="header-sub">Track contributions, interest &amp; projections</div>
                            </div>

                            {/* MONTH SELECTOR â€” 2 rows Ã— 6 cols */}
                            <div className="section-label">Select Month</div>
                            <div className="month-selector">
                                {MONTHS.map(month => (
                                    <button key={month}
                                        className={`month-btn${selectedMonth===month?' active':''}`}
                                        onClick={() => setSelectedMonth(month)}>
                                        {month.slice(0,3)}
                                    </button>
                                ))}
                            </div>

                            <div className="section-label">View</div>
                            <div className="view-toggle">
                                <button className={`toggle-btn${view==='member'?' active':''}`} onClick={()=>setView('member')}>ðŸ“± My Balance</button>
                                <button className={`toggle-btn${view==='all'?' active':''}`}    onClick={()=>setView('all')}>ðŸ‘¥ All Members</button>
                            </div>

                            {view==='member' && <MemberView month={selectedMonth} selectedAlias={selectedAlias} setSelectedAlias={setSelectedAlias} data={data} stats={stats} fileLastModified={fileLastModified} isCurrentMonth={isCurrentMonth(selectedMonth)} shouldShowWarnings={shouldShowWarnings()} />}
                            {view==='all'    && <AllMembersView month={selectedMonth} members={getAllMembersData(selectedMonth)} fileLastModified={fileLastModified} data={data} />}

                            <div className="privacy-notice">
                                <span className="privacy-lock">ðŸ”</span>
                                <div>
                                    <div className="privacy-title">Members Only â€” Confidential</div>
                                    <div className="privacy-body">This site is for LMF members only. Do not share links or screenshots outside LMF.</div>
                                </div>
                            </div>
                        </main>
                    </div>

                    {showTour && <SiteTour onDone={onTourDone} openSidebar={()=>setMobileMenuOpen(true)} closeSidebar={()=>setMobileMenuOpen(false)} onSidebarStepChange={setTourSidebarActive} />}
                    <button className="mobile-menu-toggle" onClick={()=>setMobileMenuOpen(!mobileMenuOpen)}>â˜°</button>
                </>
            );
        }

        /* â”€â”€ MEMBER PROJECTION CHART â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        function MemberProjectionChart({ selectedAlias, data, currentMonth }) {
            const chartRef         = React.useRef(null);
            const chartInstanceRef = React.useRef(null);

            React.useEffect(() => {
                if (!chartRef.current || !selectedAlias || !data) return;
                if (chartInstanceRef.current) chartInstanceRef.current.destroy();

                const ctx        = chartRef.current.getContext('2d');
                const monthIndex = MONTHS.indexOf(currentMonth);
                const labels     = MONTHS.map(m => m.slice(0, 3));

                // â”€â”€ DATASET 1: Bars â€” actual deposits only (null for future months, no bar rendered)
                let totalTopups = 0;
                const actualDeposits = [];
                const actualBalances = [];

                for (let i = 0; i <= monthIndex; i++) {
                    const md = data[MONTHS[i]]?.[selectedAlias] || {};
                    const topup   = md.topups        || 0;
                    const balance = md.closingBalance || 0;
                    actualDeposits.push(topup);
                    actualBalances.push(balance);
                    totalTopups += topup;
                }

                // Average based on months elapsed (used for projection)
                const avg = (monthIndex + 1) > 0 ? totalTopups / (monthIndex + 1) : MINIMUM_CONTRIBUTION;

                // Bars: actual data for elapsed months, null for future (no bar rendered)
                const barData = [...actualDeposits, ...Array(11 - monthIndex).fill(null)];
                const barColors  = actualDeposits.map(v =>
                    v >= MINIMUM_CONTRIBUTION ? 'rgba(0,229,160,0.78)' : v > 0 ? 'rgba(245,158,11,0.78)' : 'rgba(248,113,113,0.55)'
                ).concat(Array(11 - monthIndex).fill('transparent'));
                const barBorders = actualDeposits.map(v =>
                    v >= MINIMUM_CONTRIBUTION ? '#00e5a0' : v > 0 ? '#f59e0b' : '#f87171'
                ).concat(Array(11 - monthIndex).fill('transparent'));

                // â”€â”€ DATASET 2: Line â€” actual closing balance per month (null for future)
                const balanceLine = [...actualBalances, ...Array(11 - monthIndex).fill(null)];

                // â”€â”€ DATASET 3: Line â€” projected balance starting from current month's actual balance
                const lastBal  = actualBalances[actualBalances.length - 1] || 0;
                const projLine = Array(12).fill(null);
                projLine[monthIndex] = lastBal;  // anchor to last actual point
                for (let i = monthIndex + 1; i < 12; i++) {
                    const prev = projLine[i - 1];
                    projLine[i] = (prev + avg) * (1 + ETICA_MONTHLY_YIELD);
                }

                chartInstanceRef.current = new Chart(ctx, {
                    data: {
                        labels,
                        datasets: [
                            {
                                type: 'bar',
                                label: 'Monthly Deposit',
                                data: barData,
                                backgroundColor: barColors,
                                borderColor: barBorders,
                                borderWidth: 1.5,
                                borderRadius: 4,
                                yAxisID: 'y',
                                order: 3,
                            },
                            {
                                type: 'line',
                                label: 'Balance to Date',
                                data: balanceLine,
                                borderColor: '#00e5a0',
                                backgroundColor: 'transparent',
                                borderWidth: 2.5,
                                pointBackgroundColor: '#00e5a0',
                                pointBorderColor: '#00e5a0',
                                pointRadius: 4,
                                pointHoverRadius: 6,
                                fill: false,
                                tension: 0.3,
                                yAxisID: 'y',
                                order: 1,
                                spanGaps: false,
                            },
                            {
                                type: 'line',
                                label: 'Projected Balance',
                                data: projLine,
                                borderColor: '#60a5fa',
                                backgroundColor: 'transparent',
                                borderWidth: 2,
                                borderDash: [6, 4],
                                pointBackgroundColor: '#60a5fa',
                                pointBorderColor: '#60a5fa',
                                pointRadius: 3,
                                pointHoverRadius: 5,
                                fill: false,
                                tension: 0.3,
                                yAxisID: 'y',
                                order: 2,
                                spanGaps: false,
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: { mode: 'index', intersect: false },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    color: 'rgba(240,240,248,0.55)',
                                    font: { size: 10, family: 'Space Grotesk' },
                                    boxWidth: 10, padding: 12
                                }
                            },
                            tooltip: {
                                backgroundColor: '#1a1a2e',
                                titleColor: '#00e5a0',
                                bodyColor: '#f0f0f8',
                                borderColor: 'rgba(0,229,160,0.25)',
                                borderWidth: 1,
                                callbacks: {
                                    label: ctx => {
                                        const v = ctx.parsed.y;
                                        if (v === null || v === undefined) return null;
                                        return `${ctx.dataset.label}: KES ${Math.round(v).toLocaleString()}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                position: 'left',
                                beginAtZero: true,
                                ticks: {
                                    color: 'rgba(240,240,248,0.35)',
                                    font: { size: 9 },
                                    callback: v => 'KES ' + (v / 1000).toFixed(0) + 'k'
                                },
                                grid: { color: 'rgba(255,255,255,0.04)' }
                            },
                            x: {
                                ticks: { color: 'rgba(240,240,248,0.35)', font: { size: 9 } },
                                grid: { display: false }
                            }
                        }
                    }
                });

                return () => { if (chartInstanceRef.current) chartInstanceRef.current.destroy(); };
            }, [selectedAlias, data, currentMonth]);

            if (!selectedAlias) return null;

            // Build hist for motivation card
            const monthIndex = MONTHS.indexOf(currentMonth);
            const hist = { totalTopups:0, totalInterest:0, currentMonthTopup:0, currentInterest:0, previousMonthTopup:0, previousInterest:0, closingBalance:0, daysActive:0 };
            for (let i = 0; i <= monthIndex; i++) {
                const md = data[MONTHS[i]]?.[selectedAlias] || {};
                hist.totalTopups   += md.topups   || 0;
                hist.totalInterest += md.interest || 0;
                if (i === monthIndex)   { hist.currentMonthTopup = md.topups||0; hist.currentInterest = md.interest||0; hist.closingBalance = md.closingBalance||0; hist.daysActive = md.daysActive||0; }
                if (i === monthIndex-1) { hist.previousMonthTopup = md.topups||0; hist.previousInterest = md.interest||0; }
            }
            const allMD      = MEMBERS.map(a => ({ alias:a, closingBalance: data[currentMonth]?.[a]?.closingBalance||0 }));
            const archetype  = calculateMemberArchetype(hist, allMD, currentMonth);
            const motivation = formatArchetypeMessage(archetype, hist, allMD, currentMonth);

            return (
                <div style={{marginTop:'14px'}}>
                    <div className="chart-card">
                        <div className="chart-card-label">Contributions &amp; Balance Growth</div>
                        <div className="chart-card-sub">
                            <span style={{color:'var(--accent)'}}>â–Š</span> Monthly top-ups &nbsp;
                            <span style={{color:'var(--accent)'}}>â€”â€”</span> Balance to date &nbsp;
                            <span style={{color:'var(--blue)'}}>â•Œâ•Œ</span> Projected to Dec
                        </div>
                        <div style={{height:'250px', position:'relative'}}><canvas ref={chartRef}/></div>
                    </div>
                    <div className="motivation-card">
                        <span className="motivation-icon">{motivation.icon}</span>
                        <p className="motivation-text">{motivation.text}</p>
                    </div>
                </div>
            );
        }

        /* â”€â”€ MEMBER VIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        function MemberView({ month, selectedAlias, setSelectedAlias, data, stats, fileLastModified, isCurrentMonth, shouldShowWarnings }) {
            const md = data[month]?.[selectedAlias] || { openingBalance:0, topups:0, interest:0, daysActive:0, closingBalance:0 };
            const partner = MEMBER_PAIRS[selectedAlias];
            let showWarning=false, warningMsg='';
            if (isCurrentMonth && shouldShowWarnings && selectedAlias) {
                if (partner) {
                    const pd = data[month]?.[partner] || {topups:0};
                    const combined = md.topups + pd.topups;
                    if (combined>0 && combined<MINIMUM_CONTRIBUTION) {
                        showWarning=true;
                        const rmsg = PARTIAL_CONTRIBUTION_MESSAGES[Math.floor(Math.random()*PARTIAL_CONTRIBUTION_MESSAGES.length)];
                        warningMsg = rmsg(combined, MINIMUM_CONTRIBUTION-combined)+` (Combined with ${partner})`;
                    } else if (combined===0) {
                        showWarning=true;
                        warningMsg = `Your combined ${month} contribution with ${partner} hasn't been recorded yet. Please coordinate to deposit KES ${MINIMUM_CONTRIBUTION.toLocaleString()} soon.`;
                    }
                } else {
                    if (md.topups>0 && md.topups<MINIMUM_CONTRIBUTION) {
                        showWarning=true;
                        const rmsg = PARTIAL_CONTRIBUTION_MESSAGES[Math.floor(Math.random()*PARTIAL_CONTRIBUTION_MESSAGES.length)];
                        warningMsg = rmsg(md.topups, MINIMUM_CONTRIBUTION-md.topups);
                    } else if (md.topups===0) {
                        showWarning=true;
                        warningMsg = `Your ${month} contribution hasn't been recorded yet. Please deposit at least KES ${MINIMUM_CONTRIBUTION.toLocaleString()} soon.`;
                    }
                }
            }
            return (
                <div className="member-view">
                    <div className="alias-selector">
                        <select value={selectedAlias} onChange={e=>setSelectedAlias(e.target.value)}>
                            <option value="" disabled>ðŸ‘† Select your alias to view balance</option>
                            {MEMBERS.map(a=><option key={a} value={a}>{a}</option>)}
                        </select>
                    </div>

                    {selectedAlias && (
                        <>
                            <div className="member-statement fade-in">
                                <div className="statement-alias">{selectedAlias}</div>
                                <div className="statement-month">{month} {CURRENT_YEAR}</div>
                                <div className="statement-row">
                                    <span className="statement-label">Opening Balance</span>
                                    <span className="statement-value">{md.openingBalance.toLocaleString('en-KE',{minimumFractionDigits:2,maximumFractionDigits:2})}</span>
                                </div>
                                <div className="statement-row">
                                    <span className="statement-label">Top-ups</span>
                                    <span className="statement-value blue">{md.topups.toLocaleString('en-KE',{minimumFractionDigits:2,maximumFractionDigits:2})}</span>
                                </div>
                                <div className="statement-row">
                                    <span className="statement-label">
                                        Interest Earned
                                        <div className="early-hint">Early deposits earn more</div>
                                    </span>
                                    <span className="statement-value green">{md.interest.toLocaleString('en-KE',{minimumFractionDigits:2,maximumFractionDigits:2})}</span>
                                </div>
                                <div className="statement-row">
                                    <span className="statement-label" style={{fontWeight:'700',color:'var(--t1)',fontSize:'1rem'}}>Current Balance</span>
                                    <span className="statement-value closing">{md.closingBalance.toLocaleString('en-KE',{minimumFractionDigits:2,maximumFractionDigits:2})}</span>
                                </div>
                                {fileLastModified && <div className="data-timestamp">Data as of {fileLastModified.toLocaleString('en-KE',{day:'2-digit',month:'2-digit',year:'numeric',hour:'2-digit',minute:'2-digit',hour12:true})}</div>}
                            </div>

                            {showWarning && (
                                <div className="warning-message">
                                    <div className="warning-icon">âš ï¸</div>
                                    <div><div className="warning-title">Friendly Reminder</div><div className="warning-content">{warningMsg}</div></div>
                                </div>
                            )}
                        </>
                    )}

                    {selectedAlias && <MemberProjectionChart selectedAlias={selectedAlias} data={data} currentMonth={month} />}

                    {!selectedAlias && stats && (
                        <div className="group-summary fade-in">
                            <div className="group-summary-title">Group Summary Â· Jan â€“ {month}</div>
                            <div className="group-summary-grid">
                                <div className="summary-item">
                                    <div className="summary-label">Total Contributions</div>
                                    <div className="summary-value">KES {stats.cumulativeContributions.toLocaleString('en-KE',{maximumFractionDigits:0})}</div>
                                </div>
                                <div className="summary-item">
                                    <div className="summary-label">Total Interest Earned</div>
                                    <div className="summary-value">KES {stats.cumulativeInterest.toLocaleString('en-KE',{maximumFractionDigits:0})}</div>
                                </div>
                                <div className="summary-item">
                                    <div className="summary-label">Group Balance</div>
                                    <div className="summary-value" style={{color:'var(--accent)'}}>KES {stats.totalBalance.toLocaleString('en-KE',{maximumFractionDigits:0})}</div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        /* â”€â”€ GROUP BALANCE CHART â€” bars (monthly totals) + projection line â”€â”€ */
        function GroupBalanceChart({ data, currentMonth }) {
            const chartRef         = React.useRef(null);
            const chartInstanceRef = React.useRef(null);

            React.useEffect(() => {
                if (!chartRef.current || !data) return;
                if (chartInstanceRef.current) chartInstanceRef.current.destroy();

                const ctx        = chartRef.current.getContext('2d');
                const monthIndex = MONTHS.indexOf(currentMonth);
                const labels     = MONTHS.map(m => m.slice(0, 3));

                // â”€â”€ Monthly group top-up totals (bars, actual months only)
                let totalTopupsAll = 0;
                const monthlyTotals = [];
                for (let i = 0; i <= monthIndex; i++) {
                    let t = 0;
                    MEMBERS.forEach(a => { t += data[MONTHS[i]]?.[a]?.topups || 0; });
                    monthlyTotals.push(t);
                    totalTopupsAll += t;
                }
                const avgMonthly = (monthIndex + 1) > 0 ? totalTopupsAll / (monthIndex + 1) : 0;

                // Bars: actual for elapsed months, null for future
                const barData    = [...monthlyTotals, ...Array(11 - monthIndex).fill(null)];
                const barColors  = monthlyTotals.map(() => 'rgba(0,229,160,0.65)');
                while (barColors.length < 12) barColors.push('transparent');
                const barBorders = monthlyTotals.map(() => '#00e5a0');
                while (barBorders.length < 12) barBorders.push('transparent');

                // â”€â”€ Group closing balance per actual month (for projection anchor)
                const actualBalances = [];
                for (let i = 0; i <= monthIndex; i++) {
                    let b = 0;
                    MEMBERS.forEach(a => { b += data[MONTHS[i]]?.[a]?.closingBalance || 0; });
                    actualBalances.push(b);
                }
                const lastBal = actualBalances[actualBalances.length - 1] || 0;

                // â”€â”€ Projection line: starts at current balance, compounds forward
                const projLine = Array(12).fill(null);
                projLine[monthIndex] = lastBal;
                for (let i = monthIndex + 1; i < 12; i++) {
                    const prev = projLine[i - 1];
                    projLine[i] = (prev + avgMonthly) * (1 + ETICA_MONTHLY_YIELD);
                }

                chartInstanceRef.current = new Chart(ctx, {
                    data: {
                        labels,
                        datasets: [
                            {
                                type: 'bar',
                                label: 'Monthly Group Total',
                                data: barData,
                                backgroundColor: barColors,
                                borderColor: barBorders,
                                borderWidth: 1.5,
                                borderRadius: 4,
                                yAxisID: 'y',
                                order: 2,
                            },
                            {
                                type: 'line',
                                label: 'Projected Balance',
                                data: projLine,
                                borderColor: '#60a5fa',
                                backgroundColor: 'transparent',
                                borderWidth: 2,
                                borderDash: [6, 4],
                                pointBackgroundColor: '#60a5fa',
                                pointBorderColor: '#60a5fa',
                                pointRadius: 3,
                                pointHoverRadius: 5,
                                fill: false,
                                tension: 0.3,
                                yAxisID: 'y',
                                order: 1,
                                spanGaps: false,
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: { mode: 'index', intersect: false },
                        plugins: {
                            legend: {
                                display: true, position: 'top',
                                labels: { color: 'rgba(240,240,248,0.55)', font: { size: 10, family: 'Space Grotesk' }, boxWidth: 10, padding: 12 }
                            },
                            tooltip: {
                                backgroundColor: '#1a1a2e', titleColor: '#00e5a0',
                                bodyColor: '#f0f0f8', borderColor: 'rgba(0,229,160,0.25)', borderWidth: 1,
                                callbacks: {
                                    label: ctx => {
                                        const v = ctx.parsed.y;
                                        if (v === null || v === undefined) return null;
                                        return `${ctx.dataset.label}: KES ${Math.round(v).toLocaleString()}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: { color: 'rgba(240,240,248,0.35)', font: { size: 9 }, callback: v => 'KES ' + (v/1000).toFixed(0) + 'k' },
                                grid: { color: 'rgba(255,255,255,0.04)' }
                            },
                            x: {
                                ticks: { color: 'rgba(240,240,248,0.35)', font: { size: 9 } },
                                grid: { display: false }
                            }
                        }
                    }
                });
                return () => { if (chartInstanceRef.current) chartInstanceRef.current.destroy(); };
            }, [data, currentMonth]);

            const monthIndex    = MONTHS.indexOf(currentMonth);
            const monthsLeft    = 11 - monthIndex;
            let totalContribs   = 0;
            for (let i = 0; i <= monthIndex; i++) MEMBERS.forEach(a => { totalContribs += data[MONTHS[i]]?.[a]?.topups || 0; });
            const avg    = (monthIndex + 1) > 0 ? totalContribs / (monthIndex + 1) : 0;
            const curBal = MEMBERS.reduce((s,a) => s + (data[currentMonth]?.[a]?.closingBalance || 0), 0);
            let projDec  = curBal;
            for (let i = 0; i < monthsLeft; i++) projDec = (projDec + avg) * (1 + ETICA_MONTHLY_YIELD);

            return (
                <div className="chart-card" style={{marginBottom:'16px'}}>
                    <div className="chart-card-label">Group Monthly Totals &amp; Projection</div>
                    <div className="chart-card-sub">
                        <span style={{color:'var(--accent)'}}>â–Š</span> Monthly top-up totals &nbsp;Â·&nbsp;
                        <span style={{color:'var(--blue)'}}>â•Œâ•Œ</span> Projected group balance to Dec &nbsp;Â·&nbsp;
                        Dec est: <strong style={{color:'var(--blue)'}}>KES {Math.round(projDec).toLocaleString()}</strong>
                    </div>
                    <div style={{height:'240px', position:'relative'}}><canvas ref={chartRef}/></div>
                </div>
            );
        }

        /* â”€â”€ ALL MEMBERS VIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        function AllMembersView({ month, members, fileLastModified, data }) {
            const totalOpening = members.reduce((s,m)=>s+m.openingBalance, 0);
            const totalTopups  = members.reduce((s,m)=>s+m.topups, 0);
            const totalInt     = members.reduce((s,m)=>s+m.interest, 0);
            const totalClosing = members.reduce((s,m)=>s+m.closingBalance, 0);

            return (
                <div>
                    <div className="all-members-header">
                        <div className="all-members-title">{month} {CURRENT_YEAR}</div>
                    </div>

                    <GroupBalanceChart data={data} currentMonth={month} />

                    <div className="members-table-container">
                        <table className="members-table">
                            <thead>
                                <tr>
                                    <th className="rank-col">#</th>
                                    <th>Alias</th>
                                    <th className="num-col">Opening</th>
                                    <th className="num-col">Top-ups</th>
                                    <th className="num-col">{month.slice(0,3)} Int.</th>
                                    <th className="num-col">Balance</th>
                                </tr>
                            </thead>
                            <tbody>
                                {members.map((member, idx) => {
                                    const dotColor = member.topups >= MINIMUM_CONTRIBUTION ? '#00e5a0' : member.topups > 0 ? '#f59e0b' : '#f87171';
                                    const dotTitle = member.topups >= MINIMUM_CONTRIBUTION ? 'âœ… Met minimum' : member.topups > 0 ? 'âš ï¸ Partial' : 'âŒ No contribution';
                                    const rank = idx + 1;
                                    return (
                                        <tr key={member.alias}>
                                            <td className="rank-col">{rank<=3?['ðŸ¥‡','ðŸ¥ˆ','ðŸ¥‰'][rank-1]:rank}</td>
                                            <td className="alias-col">{member.alias}</td>
                                            <td className="num-col">{member.openingBalance.toLocaleString('en-KE',{maximumFractionDigits:0})}</td>
                                            <td className="num-col">
                                                <div className="topup-cell">
                                                    {member.topups.toLocaleString('en-KE',{maximumFractionDigits:0})}
                                                    <span className="status-dot" title={dotTitle} style={{backgroundColor:dotColor}}/>
                                                </div>
                                            </td>
                                            <td className="num-col">{member.interest.toLocaleString('en-KE',{maximumFractionDigits:0})}</td>
                                            <td className="num-col closing">{member.closingBalance.toLocaleString('en-KE',{maximumFractionDigits:0})}</td>
                                        </tr>
                                    );
                                })}
                                <tr className="total-row">
                                    <td/>
                                    <td>TOTALS</td>
                                    <td className="num-col">{totalOpening.toLocaleString('en-KE',{maximumFractionDigits:0})}</td>
                                    <td className="num-col">{totalTopups.toLocaleString('en-KE',{maximumFractionDigits:0})}</td>
                                    <td className="num-col">{totalInt.toLocaleString('en-KE',{maximumFractionDigits:0})}</td>
                                    <td className="num-col">{totalClosing.toLocaleString('en-KE',{maximumFractionDigits:0})}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    {fileLastModified && (
                        <div className="data-timestamp" style={{textAlign:'center',marginTop:'8px'}}>
                            Data as of {fileLastModified.toLocaleString('en-KE',{day:'2-digit',month:'2-digit',year:'numeric',hour:'2-digit',minute:'2-digit',hour12:true})}
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<AppWithAuth />, document.getElementById('root'));
    </script>
</body>
</html>
